<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Computer Engineering Bytes</title>
<link>https://nishantbharali.github.io/Official-Blog/blog.html</link>
<atom:link href="https://nishantbharali.github.io/Official-Blog/blog.xml" rel="self" type="application/rss+xml"/>
<description>Nishant Bharali&#39;s engineering website built with Python and Quarto</description>
<generator>quarto-1.3.450</generator>
<lastBuildDate>Fri, 24 Nov 2023 05:00:00 GMT</lastBuildDate>
<item>
  <title>Anomaly/Outlier Detection in a Financial Dataset</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index.html</link>
  <description><![CDATA[ 



<section id="detecting-anomalies-in-financial-data-involves-using-specialized-algorithms-to-identify-irregularities-enhancing-risk-management-and-fraud-prevention" class="level2">
<h2 class="anchored" data-anchor-id="detecting-anomalies-in-financial-data-involves-using-specialized-algorithms-to-identify-irregularities-enhancing-risk-management-and-fraud-prevention">Detecting anomalies in financial data involves using specialized algorithms to identify irregularities, enhancing risk management and fraud prevention</h2>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In the modern world of finance, data plays a pivotal role in decision-making processes. Financial datasets often contain critical information about customers, transactions, and more. One crucial aspect of financial data analysis is the detection of anomalies or outliers. Anomalies are data points that significantly deviate from the norm or expected behavior. Detecting these anomalies is essential for fraud detection, risk management, and maintaining data integrity.</p>
<p>This report explores the application of anomaly/outlier detection techniques to a financial dataset. The dataset under consideration contains information such as Age, Income, Transaction Amount, Transaction Type, and Location. We aim to identify unusual patterns or data points within this dataset that may require further investigation.</p>
<p><strong>Advanced Analysis</strong></p>
<p>I will now conduct an advanced analysis of this dataset, focusing on the following aspects:</p>
<p>Data Exploration: Understanding the basic statistics of the dataset. Visualization: Plotting the data to observe any unusual patterns. Anomaly Detection Techniques: Implementing various methods to detect outliers, such as statistical methods, clustering-based methods, and machine learning models. For this analysis, I will be using Python libraries like Pandas, NumPy, Matplotlib, Seaborn, and Scikit-Learn. Let’s start with the data exploration and visualization.</p>
<p><strong>Analysis Overview</strong></p>
<p><strong>Data Exploration</strong></p>
<p>The descriptive statistics of the dataset provide a basic understanding of its features:</p>
<p>A. Age: Ranges from 18 to 69, with an average of around 43 years. B. Income: The average income is approximately $51,518, with a wide range from around $988 to $181,196, suggesting significant variance. C. Transaction Amount: On average, transactions are around $200, but there are values as high as $1,999, which might indicate potential outliers.</p>
<p><strong>Visualization Insights</strong></p>
<p>A. Histograms: These show the distribution of numerical features. While age appears fairly uniformly distributed, income and transaction amounts show right-skewed distributions. B. Boxplots: The boxplots highlight potential outliers, especially in the income and transaction amount data. PCA Scatter Plot: After applying PCA for dimensionality reduction, we get a 2D visualization of the scaled numerical data. This plot can help us identify clusters and potential outliers visually.</p>
<p><strong>Next Steps for Anomaly Detection</strong></p>
<p>Based on these visualizations and statistics, the next step is to apply anomaly detection techniques. I will use the Isolation Forest algorithm, a popular method for outlier detection, especially effective with high-dimensional datasets. This method isolates anomalies instead of profiling normal data points. Anomalies are few and different, hence easier to isolate.</p>
<p><strong>Data Exploration and Analysis</strong></p>
<p>I applied the Isolation Forest algorithm to our scaled numerical data and identify the anomalies. Let’s proceed with this analysis.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.ensemble <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IsolationForest</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StandardScaler</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.decomposition <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PCA</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loading the dataset</span></span>
<span id="cb1-9">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'anomaly_detection_dataset.csv'</span>)</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Exploration: Descriptive statistics</span></span>
<span id="cb1-12">descriptive_stats <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.describe()</span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display basic statistics</span></span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualization</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Histograms for numerical data</span></span>
<span id="cb1-17">fig, axes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(nrows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb1-18">df[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Age'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Income'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Transaction Amount'</span>]].hist(bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>axes, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'skyblue'</span>)</span>
<span id="cb1-19">plt.suptitle(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Histograms of Numerical Features'</span>)</span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Boxplot for numerical data to check for outliers</span></span>
<span id="cb1-22">fig, axes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(nrows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb1-23">sns.boxplot(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Age'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Income'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Transaction Amount'</span>]], ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb1-24">sns.boxplot(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Income'</span>]], ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-25">sns.boxplot(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Transaction Amount'</span>]], ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb1-26">plt.suptitle(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Boxplots of Numerical Features'</span>)</span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Preparing data for anomaly detection</span></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Standardizing the numerical data</span></span>
<span id="cb1-30">scaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StandardScaler()</span>
<span id="cb1-31">scaled_numerical_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaler.fit_transform(df[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Age'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Income'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Transaction Amount'</span>]])</span>
<span id="cb1-32"></span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Applying PCA for dimensionality reduction (2D visualization)</span></span>
<span id="cb1-34">pca <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PCA(n_components<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-35">pca_results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pca.fit_transform(scaled_numerical_data)</span>
<span id="cb1-36">pca_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pca_results, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PC1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PC2'</span>])</span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scatter plot of PCA results</span></span>
<span id="cb1-39">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb1-40">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PC1'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PC2'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pca_df)</span>
<span id="cb1-41">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PCA of Scaled Numerical Data'</span>)</span>
<span id="cb1-42"></span>
<span id="cb1-43">plt.show()</span>
<span id="cb1-44"></span>
<span id="cb1-45">descriptive_stats, pca_df.head()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-2-output-1.png" width="1385" height="459"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-2-output-2.png" width="1418" height="459"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-2-output-3.png" width="810" height="523"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(               Age         Income  Transaction Amount
 count  1000.000000    1000.000000         1000.000000
 mean     43.267000   51518.424999          200.855857
 std      15.242311   18506.474035          197.923861
 min      18.000000     988.660890            0.381117
 25%      30.000000   39745.904804           79.905356
 50%      43.000000   50483.467494          162.361081
 75%      56.000000   60698.045016          264.145550
 max      69.000000  181196.443031         1999.137390,
         PC1       PC2
 0 -0.301194 -1.080589
 1 -0.282737 -0.824039
 2 -0.474600  2.067434
 3  0.344241  0.305833
 4 -0.009123  0.894454)</code></pre>
</div>
</div>
<p><strong>Data Visualization</strong></p>
<p>Next, we visualize the data to identify any obvious outliers or patterns.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Histograms for numerical features</span></span>
<span id="cb3-5">df.hist(bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb3-6">plt.show()</span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Box plots for numerical features to identify outliers</span></span>
<span id="cb3-9">df.plot(kind<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'box'</span>, subplots<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, layout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb3-10">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-3-output-1.png" width="1170" height="505"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-3-output-2.png" width="1161" height="310"></p>
</div>
</div>
<p><strong>Analysis Results: Anomaly Detection with Isolation Forest</strong></p>
<p><em>Anomaly Detection</em></p>
<p>The Isolation Forest algorithm was applied to the scaled numerical data, and it identified 50 anomalies in our dataset. This is consistent with the initial contamination rate set to 5% of the data.</p>
<p><em>Visualization of Detected Anomalies</em></p>
<p>The scatter plot based on the PCA results with anomalies highlighted shows:</p>
<p>A. Normal data points in blue. B. Anomalies marked in red.</p>
<p>These anomalies represent unusual patterns in terms of age, income, and transaction amounts, as identified by the Isolation Forest algorithm.</p>
<p><em>Interpretation</em></p>
<p>The visualization clearly shows that the anomalies are distinct from the bulk of the data, signifying their outlier status. These could represent unusual financial transactions or demographic anomalies that would be of interest in real-world scenarios like fraud detection or targeted marketing.</p>
<p><strong>Anomaly Detection Using Isolation Forest</strong></p>
<p>We apply the Isolation Forest algorithm to detect anomalies in the dataset. This method is effective for high-dimensional datasets and does not require prior knowledge of the number of anomalies.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.ensemble <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IsolationForest</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StandardScaler</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Standardizing the data</span></span>
<span id="cb4-5">scaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StandardScaler()</span>
<span id="cb4-6">scaled_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaler.fit_transform(df.select_dtypes(include<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'float64'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'int64'</span>]))</span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Applying Isolation Forest</span></span>
<span id="cb4-9">iso_forest <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> IsolationForest(n_estimators<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, contamination<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-10">predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iso_forest.fit_predict(scaled_data)</span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add a column for anomaly (1 for normal, -1 for anomaly)</span></span>
<span id="cb4-13">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'anomaly'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> predictions</span>
<span id="cb4-14"></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count the number of anomalies</span></span>
<span id="cb4-16">anomaly_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'anomaly'</span>].value_counts()</span>
<span id="cb4-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(anomaly_count)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>anomaly
 1    835
-1    165
Name: count, dtype: int64</code></pre>
</div>
</div>
<p><strong>Visualizing the Anomalies</strong></p>
<p>We can visualize the anomalies in the context of two principal components.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.decomposition <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PCA</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PCA for dimensionality reduction for visualization</span></span>
<span id="cb6-4">pca <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PCA(n_components<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb6-5">pca_result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pca.fit_transform(scaled_data)</span>
<span id="cb6-6"></span>
<span id="cb6-7">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca1'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pca_result[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb6-8">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca2'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pca_result[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb6-9"></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scatter plot of the PCA results colored by anomaly</span></span>
<span id="cb6-11">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca1'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca2'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'anomaly'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df, palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>})</span>
<span id="cb6-12">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Anomalies in the PCA Plane'</span>)</span>
<span id="cb6-13">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-5-output-1.png" width="587" height="449"></p>
</div>
</div>
<p><strong>K-Means Clustering for Anomaly Detection</strong></p>
<p>K-Means can be used for anomaly detection by identifying small clusters as anomalies.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.cluster <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> KMeans</span>
<span id="cb7-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># K-Means Clustering with explicit n_init parameter</span></span>
<span id="cb7-5">kmeans <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> KMeans(n_clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, n_init<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).fit(scaled_data)</span>
<span id="cb7-6">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cluster'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> kmeans.labels_</span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Detecting outliers as the points farthest from the centroids</span></span>
<span id="cb7-9">distances <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> kmeans.transform(scaled_data)</span>
<span id="cb7-10">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'distance_to_centroid'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(distances, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-11">outlier_threshold <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.percentile(df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'distance_to_centroid'</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>)</span>
<span id="cb7-12">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'outlier'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'distance_to_centroid'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> outlier_threshold</span></code></pre></div>
</div>
<p><strong>K-Means Clustering Visualization</strong></p>
<p>After running the K-Means algorithm, we can plot the data points and color them by their cluster. Points classified as outliers will be highlighted.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># K-Means Clustering Plot</span></span>
<span id="cb8-4">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb8-5">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca1'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca2'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cluster'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df, palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Set1'</span>)</span>
<span id="cb8-6">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df[df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'outlier'</span>]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca1'</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df[df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'outlier'</span>]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca2'</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Outlier'</span>)</span>
<span id="cb8-7">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'K-Means Clustering'</span>)</span>
<span id="cb8-8">plt.legend()</span>
<span id="cb8-9">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-7-output-1.png" width="810" height="523"></p>
</div>
</div>
<p><strong>DBSCAN for Anomaly Detection</strong></p>
<p>DBSCAN is effective in identifying regions of high density and isolating outliers as points in low-density areas.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.cluster <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DBSCAN</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DBSCAN Clustering</span></span>
<span id="cb9-4">dbscan <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DBSCAN(eps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, min_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>).fit(scaled_data)</span>
<span id="cb9-5">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dbscan_labels'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dbscan.labels_</span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Anomalies are points with label -1</span></span>
<span id="cb9-8">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dbscan_outlier'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dbscan_labels'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span></code></pre></div>
</div>
<p><strong>DBSCAN Visualization</strong></p>
<p>For DBSCAN, we will plot the data points and color them based on their cluster, highlighting the anomalies.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DBSCAN Plot</span></span>
<span id="cb10-2">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb10-3">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca1'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca2'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dbscan_labels'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df, palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Set2'</span>)</span>
<span id="cb10-4">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df[df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dbscan_outlier'</span>]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca1'</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df[df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dbscan_outlier'</span>]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca2'</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Outlier'</span>)</span>
<span id="cb10-5">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DBSCAN Clustering'</span>)</span>
<span id="cb10-6">plt.legend()</span>
<span id="cb10-7">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-9-output-1.png" width="810" height="523"></p>
</div>
</div>
<p><strong>Local Outlier Factor (LOF)</strong></p>
<p>LOF computes a score reflecting the degree of abnormality of the data, considering local density.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.neighbors <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LocalOutlierFactor</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LOF for anomaly detection</span></span>
<span id="cb11-4">lof <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LocalOutlierFactor(n_neighbors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, contamination<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)</span>
<span id="cb11-5">lof_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> lof.fit_predict(scaled_data)</span>
<span id="cb11-6"></span>
<span id="cb11-7">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lof_outlier'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> lof_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span></code></pre></div>
</div>
<p><strong>LOF Visualization</strong></p>
<p>Local Outlier Factor results can be visualized by highlighting the points that are identified as outliers.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LOF Plot</span></span>
<span id="cb12-2">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb12-3">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca1'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pca2'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lof_outlier'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df)</span>
<span id="cb12-4">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Local Outlier Factor'</span>)</span>
<span id="cb12-5">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-11-output-1.png" width="810" height="523"></p>
</div>
</div>
<p><strong>T-SNE for Visualization of High-Dimensional Data</strong></p>
<p>T-SNE is effective for visualizing high-dimensional data and its anomalies in a lower-dimensional space.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.manifold <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TSNE</span>
<span id="cb13-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb13-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb13-4"></span>
<span id="cb13-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make sure to replace 'scaled_data' with your actual scaled data variable name</span></span>
<span id="cb13-6">tsne <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TSNE(n_components<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb13-7">tsne_results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tsne.fit_transform(scaled_data)</span>
<span id="cb13-8"></span>
<span id="cb13-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adding T-SNE results to your DataFrame</span></span>
<span id="cb13-10">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tsne1'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tsne_results[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb13-11">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tsne2'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tsne_results[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb13-12"></span>
<span id="cb13-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use 'dbscan_labels' or another column of your choice for coloring the points</span></span>
<span id="cb13-14">column_for_coloring <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dbscan_labels'</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace with your chosen column</span></span>
<span id="cb13-15"></span>
<span id="cb13-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># T-SNE Plot</span></span>
<span id="cb13-17">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb13-18">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tsne1'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tsne2'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>column_for_coloring, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df, palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Set2'</span>, legend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full"</span>)</span>
<span id="cb13-19">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'T-SNE Visualization'</span>)</span>
<span id="cb13-20">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-12-output-1.png" width="819" height="523"></p>
</div>
</div>
<p>T-SNE results can be plotted to show how the data is distributed in the reduced-dimensional space, highlighting the anomalies detected.</p>
<p>These techniques represent a deeper dive into anomaly detection, leveraging different approaches from clustering, neural networks, and neighborhood-based methods. Each method has its strengths and can be combined or compared for a comprehensive anomaly detection strategy.</p>
<p><strong>Final check for Anomaly detection</strong></p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Applying Isolation Forest for anomaly detection</span></span>
<span id="cb14-2">iso_forest <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> IsolationForest(n_estimators<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, contamination<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb14-3">anomalies <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iso_forest.fit_predict(scaled_numerical_data)</span>
<span id="cb14-4"></span>
<span id="cb14-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adding the anomaly predictions to the PCA DataFrame</span></span>
<span id="cb14-6">pca_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Anomaly'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> anomalies</span>
<span id="cb14-7"></span>
<span id="cb14-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizing the identified anomalies on the PCA plot</span></span>
<span id="cb14-9">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb14-10">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PC1'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PC2'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Anomaly'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pca_df, palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>})</span>
<span id="cb14-11">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PCA of Scaled Numerical Data with Anomalies Highlighted'</span>)</span>
<span id="cb14-12">plt.legend(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Anomaly'</span>, loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upper right'</span>, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Normal'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Anomaly'</span>])</span>
<span id="cb14-13"></span>
<span id="cb14-14">plt.show()</span>
<span id="cb14-15"></span>
<span id="cb14-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Counting the number of detected anomalies</span></span>
<span id="cb14-17">num_anomalies_detected <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (anomalies <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb14-18"></span>
<span id="cb14-19">num_anomalies_detected, pca_df.head()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index_files/figure-html/cell-13-output-1.png" width="810" height="523"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(50,
         PC1       PC2  Anomaly
 0 -0.301194 -1.080589        1
 1 -0.282737 -0.824039        1
 2 -0.474600  2.067434        1
 3  0.344241  0.305833        1
 4 -0.009123  0.894454        1)</code></pre>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>In conclusion, the analysis of anomalies and outliers in financial datasets is of paramount importance for safeguarding financial systems and ensuring data quality. In this report, we delved into the application of various techniques to detect anomalies in a financial dataset containing Age, Income, Transaction Amount, Transaction Type, and Location. The results of this analysis can guide decision-makers in identifying potential issues, such as fraudulent transactions or data entry errors.</p>
<p>By leveraging advanced analytics and machine learning algorithms, financial institutions can proactively mitigate risks, enhance customer trust, and streamline their operations. The continuous monitoring and refinement of anomaly detection methods are critical in the ever-evolving landscape of finance.</p>
<p>As financial data continues to grow in complexity and volume, the ability to detect anomalies accurately becomes increasingly crucial. It is essential for organizations to stay vigilant and adapt their anomaly detection strategies to stay ahead of emerging threats and challenges in the financial sector.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>machine learning</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/index.html</guid>
  <pubDate>Fri, 24 Nov 2023 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/Anomaly-Outlier Detection/image2.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Advanced Classification techniques with Model Prediction Analysis</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/Classification/index.html</link>
  <description><![CDATA[ 



<section id="advanced-classification-techniques-with-model-prediction-analysis" class="level4">
<h4 class="anchored" data-anchor-id="advanced-classification-techniques-with-model-prediction-analysis">Advanced Classification techniques with Model Prediction Analysis</h4>
</section>
<section id="implementing-advanced-classification-techniques-for-precise-model-prediction-analysis-to-enhance-accuracy-and-efficiency" class="level2">
<h2 class="anchored" data-anchor-id="implementing-advanced-classification-techniques-for-precise-model-prediction-analysis-to-enhance-accuracy-and-efficiency">Implementing advanced classification techniques for precise model prediction analysis to enhance accuracy and efficiency**</h2>
<p><strong>Introduction</strong></p>
<p>Machine learning is a fascinating field that empowers computers to learn and make predictions or decisions without being explicitly programmed. One of the fundamental tasks in machine learning is classification, where the goal is to categorize data points into predefined classes or labels. In this blog post, we dive deep into the world of classification, exploring advanced techniques and their application on a real-world dataset.</p>
<p>The Iris dataset is a well-known benchmark in the machine learning community. It consists of measurements of four features from three different species of iris flowers. This seemingly simple dataset serves as an excellent playground for understanding and implementing classification algorithms. However, we won’t stop at the basics; we’ll explore advanced classification techniques, model tuning, and even dive into ensemble methods and neural networks.</p>
<p><strong>Data Loading and Preliminary Analysis</strong></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importing essential libraries</span></span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load dataset</span></span>
<span id="cb1-8">iris_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Iris_dataset.csv'</span>)</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Basic dataset information</span></span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(iris_df.head())</span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(iris_df.describe())</span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(iris_df.info())</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizing the distribution of classes</span></span>
<span id="cb1-16">sns.countplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>iris_df)</span>
<span id="cb1-17">plt.show()</span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pairplot to explore relationships between features</span></span>
<span id="cb1-20">sns.pairplot(iris_df, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>)</span>
<span id="cb1-21">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)  \
0           6.370695          2.771952           5.118790          1.542084   
1           5.979286          2.612095           5.086595          1.560228   
2           6.741563          2.804321           4.758669          1.443702   
3           6.346538          2.796799           5.601084          2.114922   
4           5.558280          2.831451           4.876331          2.045125   

      species  
0   virginica  
1  versicolor  
2  versicolor  
3   virginica  
4   virginica  
       sepal length (cm)  sepal width (cm)  petal length (cm)  \
count        3000.000000       3000.000000        3000.000000   
mean            5.844003          3.055776           3.756746   
std             0.825203          0.435899           1.761100   
min             4.180767          1.918769           0.907839   
25%             5.118694          2.780525           1.559288   
50%             5.777010          3.025634           4.347984   
75%             6.416866          3.342169           5.098831   
max             7.963257          4.516746           7.046886   

       petal width (cm)  
count       3000.000000  
mean           1.199022  
std            0.760822  
min           -0.048888  
25%            0.310048  
50%            1.326659  
75%            1.818514  
max            2.601413  
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 3000 entries, 0 to 2999
Data columns (total 5 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   sepal length (cm)  3000 non-null   float64
 1   sepal width (cm)   3000 non-null   float64
 2   petal length (cm)  3000 non-null   float64
 3   petal width (cm)   3000 non-null   float64
 4   species            3000 non-null   object 
dtypes: float64(4), object(1)
memory usage: 117.3+ KB
None</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-2-output-2.png" width="601" height="429"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-2-output-3.png" width="1069" height="947"></p>
</div>
</div>
<p><strong>Data Preprocessing</strong></p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> train_test_split</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LabelEncoder, StandardScaler</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Encoding categorical data</span></span>
<span id="cb3-5">encoder <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LabelEncoder()</span>
<span id="cb3-6">iris_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encoder.fit_transform(iris_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>])</span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Splitting dataset into features and target variable</span></span>
<span id="cb3-9">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris_df.drop(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-10">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>]</span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Splitting dataset into training and testing sets</span></span>
<span id="cb3-13">X_train, X_test, y_train, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_test_split(X, y, test_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Feature scaling</span></span>
<span id="cb3-16">scaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StandardScaler()</span>
<span id="cb3-17">X_train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaler.fit_transform(X_train)</span>
<span id="cb3-18">X_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaler.transform(X_test)</span></code></pre></div>
</div>
<p><strong>Exploratory Data Analysis (EDA)</strong></p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Correlation heatmap</span></span>
<span id="cb4-2">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb4-3">sns.heatmap(iris_df.corr(), annot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'viridis'</span>)</span>
<span id="cb4-4">plt.show()</span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Advanced pairplot with distribution and regression</span></span>
<span id="cb4-7">sns.pairplot(iris_df, kind<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reg'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>)</span>
<span id="cb4-8">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-4-output-1.png" width="745" height="638"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-4-output-2.png" width="1016" height="947"></p>
</div>
</div>
<p><strong>Model Building and Evaluation For Classification</strong></p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.metrics <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> classification_report, confusion_matrix</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.tree <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DecisionTreeClassifier</span>
<span id="cb5-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.ensemble <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RandomForestClassifier, GradientBoostingClassifier</span>
<span id="cb5-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.svm <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SVC</span>
<span id="cb5-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.neighbors <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> KNeighborsClassifier</span>
<span id="cb5-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.linear_model <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LogisticRegression</span>
<span id="cb5-7"></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to train and evaluate models</span></span>
<span id="cb5-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> train_evaluate_model(model, X_train, y_train, X_test, y_test):</span>
<span id="cb5-10">    model.fit(X_train, y_train)</span>
<span id="cb5-11">    predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.predict(X_test)</span>
<span id="cb5-12">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Model: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>__class__<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb5-13">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(classification_report(y_test, predictions))</span>
<span id="cb5-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Confusion matrix</span></span>
<span id="cb5-15">    cm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> confusion_matrix(y_test, predictions)</span>
<span id="cb5-16">    sns.heatmap(cm, annot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb5-17">    plt.show()</span>
<span id="cb5-18"></span>
<span id="cb5-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Decision Tree Classifier</span></span>
<span id="cb5-20">train_evaluate_model(DecisionTreeClassifier(), X_train, y_train, X_test, y_test)</span>
<span id="cb5-21"></span>
<span id="cb5-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RandomForestClassifier</span></span>
<span id="cb5-23">train_evaluate_model(RandomForestClassifier(), X_train, y_train, X_test, y_test)</span>
<span id="cb5-24"></span>
<span id="cb5-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GradientBoostingClassifier</span></span>
<span id="cb5-26">train_evaluate_model(GradientBoostingClassifier(), X_train, y_train, X_test, y_test)</span>
<span id="cb5-27"></span>
<span id="cb5-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Support Vector Machine (SVC)</span></span>
<span id="cb5-29">train_evaluate_model(SVC(), X_train, y_train, X_test, y_test)</span>
<span id="cb5-30"></span>
<span id="cb5-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># K-Nearest Neighbors (KNN)</span></span>
<span id="cb5-32">train_evaluate_model(KNeighborsClassifier(), X_train, y_train, X_test, y_test)</span>
<span id="cb5-33"></span>
<span id="cb5-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Logistic Regression</span></span>
<span id="cb5-35">train_evaluate_model(LogisticRegression(), X_train, y_train, X_test, y_test)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: DecisionTreeClassifier
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       289
           1       0.99      0.98      0.98       299
           2       0.98      0.99      0.99       312

    accuracy                           0.99       900
   macro avg       0.99      0.99      0.99       900
weighted avg       0.99      0.99      0.99       900

Model: RandomForestClassifier
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       289
           1       0.99      0.99      0.99       299
           2       0.99      0.99      0.99       312

    accuracy                           1.00       900
   macro avg       1.00      1.00      1.00       900
weighted avg       1.00      1.00      1.00       900

Model: GradientBoostingClassifier
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       289
           1       0.99      0.99      0.99       299
           2       0.99      0.99      0.99       312

    accuracy                           1.00       900
   macro avg       1.00      1.00      1.00       900
weighted avg       1.00      1.00      1.00       900

Model: SVC
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       289
           1       0.99      0.96      0.98       299
           2       0.97      0.99      0.98       312

    accuracy                           0.98       900
   macro avg       0.99      0.98      0.98       900
weighted avg       0.98      0.98      0.98       900

Model: KNeighborsClassifier
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       289
           1       1.00      1.00      1.00       299
           2       1.00      1.00      1.00       312

    accuracy                           1.00       900
   macro avg       1.00      1.00      1.00       900
weighted avg       1.00      1.00      1.00       900

Model: LogisticRegression
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       289
           1       0.98      0.95      0.97       299
           2       0.96      0.98      0.97       312

    accuracy                           0.98       900
   macro avg       0.98      0.98      0.98       900
weighted avg       0.98      0.98      0.98       900
</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-5-output-2.png" width="537" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-5-output-3.png" width="537" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-5-output-4.png" width="537" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-5-output-5.png" width="537" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-5-output-6.png" width="537" height="411"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-5-output-7.png" width="537" height="411"></p>
</div>
</div>
<p>In this code, we introduce different types of classification models, including Random Forest Classifier, Gradient Boosting Classifier, Support Vector Classifier (SVC), K-Nearest Neighbors Classifier (KNN), and Logistic Regression.</p>
<p>For each model, we train it on the training data and evaluate its performance using accuracy and a classification report that includes precision, recall, and F1-score. This allows you to compare the performance of various classification algorithms on the Iris dataset.</p>
<p><strong>Advanced Model Tuning and Analysis</strong></p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> GridSearchCV</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hyperparameter tuning for RandomForestClassifier</span></span>
<span id="cb7-4">param_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'n_estimators'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'max_features'</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sqrt'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'log2'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]}</span>
<span id="cb7-5">grid_search <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GridSearchCV(RandomForestClassifier(), param_grid, cv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb7-6">grid_search.fit(X_train, y_train)</span>
<span id="cb7-7">best_rf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_search.best_estimator_</span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluating the tuned model</span></span>
<span id="cb7-10">train_evaluate_model(best_rf, X_train, y_train, X_test, y_test)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: RandomForestClassifier
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       289
           1       0.99      0.99      0.99       299
           2       0.99      0.99      0.99       312

    accuracy                           1.00       900
   macro avg       1.00      1.00      1.00       900
weighted avg       1.00      1.00      1.00       900
</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-6-output-2.png" width="537" height="411"></p>
</div>
</div>
<p><strong>Hyperparameter Tuning for the Classification Model</strong></p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> GridSearchCV</span>
<span id="cb9-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.metrics <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> classification_report, accuracy_score</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Proper Hyperparameter tuning for Random Forest Classifier</span></span>
<span id="cb9-5">param_grid_rf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb9-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'n_estimators'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>],</span>
<span id="cb9-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'max_depth'</span>: [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>],</span>
<span id="cb9-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'min_samples_split'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>],</span>
<span id="cb9-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'min_samples_leaf'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span>
<span id="cb9-10">}</span>
<span id="cb9-11"></span>
<span id="cb9-12">grid_search_rf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GridSearchCV(RandomForestClassifier(), param_grid_rf, cv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb9-13">grid_search_rf.fit(X_train, y_train)</span>
<span id="cb9-14"></span>
<span id="cb9-15">best_rf_classifier <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_search_rf.best_estimator_</span>
<span id="cb9-16"></span>
<span id="cb9-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluating the tuned Random Forest Classifier</span></span>
<span id="cb9-18">tuned_rf_predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> best_rf_classifier.predict(X_test)</span>
<span id="cb9-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tuned Random Forest Classifier - Model Evaluation"</span>)</span>
<span id="cb9-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accuracy:"</span>, accuracy_score(y_test, tuned_rf_predictions))</span>
<span id="cb9-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Classification Report:"</span>)</span>
<span id="cb9-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(classification_report(y_test, tuned_rf_predictions))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tuned Random Forest Classifier - Model Evaluation
Accuracy: 0.9955555555555555
Classification Report:
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       289
           1       0.99      0.99      0.99       299
           2       0.99      0.99      0.99       312

    accuracy                           1.00       900
   macro avg       1.00      1.00      1.00       900
weighted avg       1.00      1.00      1.00       900
</code></pre>
</div>
</div>
<p><strong>ROC Curve Analysis for Multiple Models</strong></p>
<p>Comparing the performance of the various classification models using ROC Curve analysis, here we discuss the plots of the ROC Curve for each model. This will involve calculating the True Positive Rate (TPR) and False Positive Rate (FPR) for each model and plotting them.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.metrics <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> roc_curve, auc</span>
<span id="cb11-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> label_binarize</span>
<span id="cb11-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.multiclass <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> OneVsRestClassifier</span>
<span id="cb11-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb11-5"></span>
<span id="cb11-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Binarize the output classes for ROC analysis</span></span>
<span id="cb11-7">y_bin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> label_binarize(y, classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb11-8">n_classes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y_bin.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb11-9"></span>
<span id="cb11-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Splitting the data again for multiclass ROC analysis</span></span>
<span id="cb11-11">X_train, X_test, y_train_bin, y_test_bin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_test_split(X, y_bin, test_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb11-12"></span>
<span id="cb11-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Classifier list</span></span>
<span id="cb11-14">classifiers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb11-15">    OneVsRestClassifier(DecisionTreeClassifier()),</span>
<span id="cb11-16">    OneVsRestClassifier(RandomForestClassifier()),</span>
<span id="cb11-17">    OneVsRestClassifier(GradientBoostingClassifier()),</span>
<span id="cb11-18">    OneVsRestClassifier(SVC(probability<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)),</span>
<span id="cb11-19">    OneVsRestClassifier(KNeighborsClassifier()),</span>
<span id="cb11-20">    OneVsRestClassifier(LogisticRegression())</span>
<span id="cb11-21">]</span>
<span id="cb11-22"></span>
<span id="cb11-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting ROC Curves</span></span>
<span id="cb11-24">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb11-25"></span>
<span id="cb11-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute ROC curve and ROC area for each class</span></span>
<span id="cb11-27"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> classifier <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> classifiers:</span>
<span id="cb11-28">    classifier.fit(X_train, y_train_bin)</span>
<span id="cb11-29">    y_score <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> classifier.predict_proba(X_test)</span>
<span id="cb11-30"></span>
<span id="cb11-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute ROC curve and ROC area for each class</span></span>
<span id="cb11-32">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_classes):</span>
<span id="cb11-33">        fpr, tpr, _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> roc_curve(y_test_bin[:, i], y_score[:, i])</span>
<span id="cb11-34">        roc_auc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> auc(fpr, tpr)</span>
<span id="cb11-35">        plt.plot(fpr, tpr, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>classifier<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>estimator<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>__class__<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (area = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>roc_auc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)'</span>)</span>
<span id="cb11-36"></span>
<span id="cb11-37">plt.plot([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>)</span>
<span id="cb11-38">plt.xlim([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>])</span>
<span id="cb11-39">plt.ylim([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>])</span>
<span id="cb11-40">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'False Positive Rate'</span>)</span>
<span id="cb11-41">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'True Positive Rate'</span>)</span>
<span id="cb11-42">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Receiver Operating Characteristic for Multi-class'</span>)</span>
<span id="cb11-43">plt.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lower right"</span>)</span>
<span id="cb11-44">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-8-output-1.png" width="823" height="671"></p>
</div>
</div>
<p>This code will generate ROC curves for each of the classifiers used, providing a visual comparison of their performance in terms of the trade-off between the True Positive Rate and False Positive Rate. The area under the curve (AUC) is also displayed as a measure of the model’s performance, with a higher AUC indicating a better model. This analysis is crucial for understanding the performance of classification models, especially in multi-class settings.</p>
<p><strong>Dimensionality Reduction and Visualization</strong></p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.decomposition <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PCA</span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PCA for dimensionality reduction</span></span>
<span id="cb12-4">pca <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PCA(n_components<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb12-5">X_train_pca <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pca.fit_transform(X_train)</span>
<span id="cb12-6">X_test_pca <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pca.transform(X_test)</span>
<span id="cb12-7"></span>
<span id="cb12-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizing PCA results</span></span>
<span id="cb12-9">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb12-10">plt.scatter(X_train_pca[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], X_train_pca[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_train, cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'viridis'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Train set'</span>)</span>
<span id="cb12-11">plt.scatter(X_test_pca[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], X_test_pca[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_test, cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plasma'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Test set'</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>)</span>
<span id="cb12-12">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'First principal component'</span>)</span>
<span id="cb12-13">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Second principal component'</span>)</span>
<span id="cb12-14">plt.legend()</span>
<span id="cb12-15">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PCA of Iris Dataset'</span>)</span>
<span id="cb12-16">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-9-output-1.png" width="674" height="523"></p>
</div>
</div>
<p><strong>Additional Advanced Analysis</strong></p>
<p><strong>1. Cross-Validation</strong></p>
<p>Cross-validation is a technique used to evaluate the generalizability of a model by training and testing it on different subsets of the dataset.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> cross_val_score</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example using RandomForestClassifier</span></span>
<span id="cb13-4">rf_classifier <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RandomForestClassifier()</span>
<span id="cb13-5"></span>
<span id="cb13-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Performing 10-fold cross-validation</span></span>
<span id="cb13-7">cv_scores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cross_val_score(rf_classifier, X, y, cv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb13-8"></span>
<span id="cb13-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cross-Validation Scores for RandomForestClassifier:"</span>, cv_scores)</span>
<span id="cb13-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average Score:"</span>, np.mean(cv_scores))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cross-Validation Scores for RandomForestClassifier: [0.99666667 1.         0.99333333 0.99333333 1.         0.99666667
 0.99666667 0.99666667 1.         1.        ]
Average Score: 0.9973333333333333</code></pre>
</div>
</div>
<p><strong>2. Ensemble Methods</strong></p>
<p>Ensemble methods combine multiple models to improve the overall performance. Here, I will use an ensemble of different classifiers.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.linear_model <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LogisticRegression</span>
<span id="cb15-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.ensemble <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> VotingClassifier</span>
<span id="cb15-3"></span>
<span id="cb15-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update Logistic Regression in the ensemble</span></span>
<span id="cb15-5">classifiers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb15-6">    (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Decision Tree'</span>, DecisionTreeClassifier()),</span>
<span id="cb15-7">    (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Random Forest'</span>, RandomForestClassifier()),</span>
<span id="cb15-8">    (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Gradient Boosting'</span>, GradientBoostingClassifier()),</span>
<span id="cb15-9">    (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SVC'</span>, SVC(probability<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)),</span>
<span id="cb15-10">    (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'KNN'</span>, KNeighborsClassifier()),</span>
<span id="cb15-11">    (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Logistic Regression'</span>, LogisticRegression(max_iter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>))</span>
<span id="cb15-12">]</span>
<span id="cb15-13"></span>
<span id="cb15-14">ensemble <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> VotingClassifier(estimators<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>classifiers, voting<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'soft'</span>)</span>
<span id="cb15-15">ensemble.fit(X_train, y_train)</span>
<span id="cb15-16">ensemble_predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ensemble.predict(X_test)</span>
<span id="cb15-17"></span>
<span id="cb15-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ensemble Model Classification Report:"</span>)</span>
<span id="cb15-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(classification_report(y_test, ensemble_predictions))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ensemble Model Classification Report:
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       289
           1       1.00      0.99      0.99       299
           2       0.99      1.00      1.00       312

    accuracy                           1.00       900
   macro avg       1.00      1.00      1.00       900
weighted avg       1.00      1.00      1.00       900
</code></pre>
</div>
</div>
<p><strong>PREDICTION</strong></p>
<p><strong>Prediction: Data Preprocessing with Visualization</strong></p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> train_test_split</span>
<span id="cb17-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LabelEncoder, StandardScaler</span>
<span id="cb17-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb17-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb17-5"></span>
<span id="cb17-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Encoding categorical data</span></span>
<span id="cb17-7">encoder <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LabelEncoder()</span>
<span id="cb17-8">iris_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encoder.fit_transform(iris_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>])</span>
<span id="cb17-9"></span>
<span id="cb17-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizing the distribution of the target variable</span></span>
<span id="cb17-11">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb17-12">sns.countplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>iris_df)</span>
<span id="cb17-13">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Distribution of Target Variable (Species)'</span>)</span>
<span id="cb17-14">plt.show()</span>
<span id="cb17-15"></span>
<span id="cb17-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Splitting dataset into features and target variable</span></span>
<span id="cb17-17">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris_df.drop(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb17-18">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>]</span>
<span id="cb17-19"></span>
<span id="cb17-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Splitting dataset into training and testing sets</span></span>
<span id="cb17-21">X_train, X_test, y_train, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_test_split(X, y, test_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb17-22"></span>
<span id="cb17-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Feature scaling</span></span>
<span id="cb17-24">scaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StandardScaler()</span>
<span id="cb17-25">X_train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaler.fit_transform(X_train)</span>
<span id="cb17-26">X_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaler.transform(X_test)</span>
<span id="cb17-27"></span>
<span id="cb17-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pairplot to explore relationships between features</span></span>
<span id="cb17-29">pairplot_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris_df.copy()</span>
<span id="cb17-30">pairplot_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> encoder.inverse_transform(pairplot_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>])</span>
<span id="cb17-31"></span>
<span id="cb17-32">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb17-33">sns.pairplot(pairplot_df, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>)</span>
<span id="cb17-34">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Pairplot of Features with Species as Hue'</span>)</span>
<span id="cb17-35">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-12-output-1.png" width="676" height="449"></p>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 960x768 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-12-output-3.png" width="1016" height="947"></p>
</div>
</div>
<p><strong>Model Building, Evaluation, and Visualization for Prediction</strong></p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.metrics <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> mean_squared_error, r2_score</span>
<span id="cb19-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.linear_model <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LinearRegression</span>
<span id="cb19-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.tree <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DecisionTreeRegressor</span>
<span id="cb19-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.ensemble <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RandomForestRegressor</span>
<span id="cb19-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb19-6"></span>
<span id="cb19-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to train and evaluate regression models</span></span>
<span id="cb19-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> train_evaluate_regression_model(model, X_train, y_train, X_test, y_test):</span>
<span id="cb19-9">    model.fit(X_train, y_train)</span>
<span id="cb19-10">    predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.predict(X_test)</span>
<span id="cb19-11">    </span>
<span id="cb19-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model Evaluation</span></span>
<span id="cb19-13">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Model: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>__class__<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb19-14">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Mean Squared Error: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>mean_squared_error(y_test, predictions)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb19-15">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'R-squared (R2) Score: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>r2_score(y_test, predictions)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb19-16">    </span>
<span id="cb19-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualization</span></span>
<span id="cb19-18">    plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb19-19">    plt.scatter(y_test, predictions)</span>
<span id="cb19-20">    plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'True Values'</span>)</span>
<span id="cb19-21">    plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predictions'</span>)</span>
<span id="cb19-22">    plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>__class__<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> - True vs. Predicted Values'</span>)</span>
<span id="cb19-23">    plt.show()</span>
<span id="cb19-24"></span>
<span id="cb19-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Linear Regression</span></span>
<span id="cb19-26">train_evaluate_regression_model(LinearRegression(), X_train, y_train, X_test, y_test)</span>
<span id="cb19-27"></span>
<span id="cb19-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Decision Tree Regressor</span></span>
<span id="cb19-29">train_evaluate_regression_model(DecisionTreeRegressor(), X_train, y_train, X_test, y_test)</span>
<span id="cb19-30"></span>
<span id="cb19-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Random Forest Regressor</span></span>
<span id="cb19-32">train_evaluate_regression_model(RandomForestRegressor(), X_train, y_train, X_test, y_test)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: LinearRegression
Mean Squared Error: 0.047703003079178956
R-squared (R2) Score: 0.9284946222241109
Model: DecisionTreeRegressor
Mean Squared Error: 0.01
R-squared (R2) Score: 0.9850102984801183
Model: RandomForestRegressor
Mean Squared Error: 0.006380666666666666
R-squared (R2) Score: 0.9904355711168809</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-13-output-2.png" width="663" height="449"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-13-output-3.png" width="672" height="449"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-13-output-4.png" width="672" height="449"></p>
</div>
</div>
<p><strong>Advanced Model Tuning and Analysis for Prediction</strong></p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> GridSearchCV</span>
<span id="cb21-2"></span>
<span id="cb21-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hyperparameter tuning for Random Forest Regressor</span></span>
<span id="cb21-4">param_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb21-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'n_estimators'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>],</span>
<span id="cb21-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'max_depth'</span>: [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>],</span>
<span id="cb21-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'min_samples_split'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>],</span>
<span id="cb21-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'min_samples_leaf'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span>
<span id="cb21-9">}</span>
<span id="cb21-10"></span>
<span id="cb21-11">grid_search <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GridSearchCV(RandomForestRegressor(), param_grid, cv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, scoring<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'neg_mean_squared_error'</span>)</span>
<span id="cb21-12">grid_search.fit(X_train, y_train)</span>
<span id="cb21-13"></span>
<span id="cb21-14">best_rf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_search.best_estimator_</span>
<span id="cb21-15"></span>
<span id="cb21-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluating the tuned model</span></span>
<span id="cb21-17">predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> best_rf.predict(X_test)</span>
<span id="cb21-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tuned Random Forest Regressor - Model Evaluation"</span>)</span>
<span id="cb21-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Mean Squared Error: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>mean_squared_error(y_test, predictions)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb21-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'R-squared (R2) Score: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>r2_score(y_test, predictions)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tuned Random Forest Regressor - Model Evaluation
Mean Squared Error: 0.005469777777777778
R-squared (R2) Score: 0.9918009663731029</code></pre>
</div>
</div>
<p><strong>Feature Selection and Importance Analysis</strong></p>
<p>Feature selection is crucial for improving model performance and reducing overfitting. Here, we use techniques like Recursive Feature Elimination (RFE) and feature importance analysis to select the most relevant features for classification or prediction.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.feature_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RFE</span>
<span id="cb23-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.linear_model <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LogisticRegression</span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using Recursive Feature Elimination (RFE) with Logistic Regression</span></span>
<span id="cb23-5">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LogisticRegression()</span>
<span id="cb23-6">rfe <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RFE(model, n_features_to_select<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select the top 3 features</span></span>
<span id="cb23-7">fit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rfe.fit(X_train, y_train)</span>
<span id="cb23-8"></span>
<span id="cb23-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># List of selected features</span></span>
<span id="cb23-10">selected_features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [feature <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> idx, feature <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(X.columns) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> fit.support_[idx]]</span>
<span id="cb23-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Selected Features:"</span>, selected_features)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Selected Features: ['sepal width (cm)', 'petal length (cm)', 'petal width (cm)']</code></pre>
</div>
</div>
<p>Additionally, we can analyze feature importance for tree-based models like Random Forest or Gradient Boosting to understand which features contribute the most to predictions.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.ensemble <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RandomForestClassifier</span>
<span id="cb25-2"></span>
<span id="cb25-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Feature Importance Analysis for Random Forest Classifier</span></span>
<span id="cb25-4">rf_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RandomForestClassifier()</span>
<span id="cb25-5">rf_model.fit(X_train, y_train)</span>
<span id="cb25-6"></span>
<span id="cb25-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot feature importance</span></span>
<span id="cb25-8">feature_importance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.Series(rf_model.feature_importances_, index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>X.columns)</span>
<span id="cb25-9">feature_importance.nlargest(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>).plot(kind<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'barh'</span>)</span>
<span id="cb25-10">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Feature Importance (Random Forest)"</span>)</span>
<span id="cb25-11">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Classification/index_files/figure-html/cell-16-output-1.png" width="666" height="431"></p>
</div>
</div>
<p><strong>Handling Class Imbalance</strong></p>
<p>In real-world datasets, class imbalance is common, where one class has significantly fewer samples than others. Techniques like oversampling, undersampling, and Synthetic Minority Over-sampling Technique (SMOTE) can be employed to address this issue.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> imblearn.over_sampling <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SMOTE</span>
<span id="cb26-2"></span>
<span id="cb26-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using SMOTE to handle class imbalance</span></span>
<span id="cb26-4">smote <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SMOTE(sampling_strategy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>)</span>
<span id="cb26-5">X_train_resampled, y_train_resampled <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> smote.fit_resample(X_train, y_train)</span></code></pre></div>
</div>
<p><strong>Conclusion</strong></p>
<p>In this journey through the Iris dataset and the realm of classification, we’ve covered a wide range of topics. Starting with data loading and preprocessing, we explored the relationships between features, ensuring that we understood our data thoroughly. We then introduced a variety of classification models, from decision trees to support vector machines, and compared their performance using robust evaluation metrics.</p>
<p>But we didn’t stop there. We delved into advanced techniques, including cross-validation to ensure the generalizability of our models, ensemble methods that combined the strengths of multiple classifiers, and even a taste of neural networks for classification tasks.</p>
<p>Our exploration of ROC curves allowed us to visualize and compare the trade-offs between true positive and false positive rates across different models, providing valuable insights into their performance.</p>
<p>In the end, classification is a powerful tool in the machine learning toolkit, with applications ranging from medical diagnosis to spam email filtering. The Iris dataset served as an ideal playground to learn and experiment with these techniques, but the knowledge gained can be applied to more complex and real-world classification problems.</p>
<p>As you continue your journey in machine learning, remember that classification is just the tip of the iceberg. The world of machine learning is vast and ever-evolving, and there are countless exciting challenges and opportunities awaiting those who dare to explore it further.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>machine learning</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/Classification/index.html</guid>
  <pubDate>Fri, 24 Nov 2023 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/Classification/image1.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Advanced Clustering and Prediction techniques</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/Clustering/index.html</link>
  <description><![CDATA[ 



<section id="advanced-clustering-and-prediction-techniques-using-retail-customer-data" class="level4">
<h4 class="anchored" data-anchor-id="advanced-clustering-and-prediction-techniques-using-retail-customer-data">Advanced Clustering and Prediction techniques Using Retail Customer Data</h4>
</section>
<section id="employing-sophisticated-clustering-techniques-with-retail-customer-data-and-comparing-further-with-prediction-models" class="level2">
<h2 class="anchored" data-anchor-id="employing-sophisticated-clustering-techniques-with-retail-customer-data-and-comparing-further-with-prediction-models">Employing sophisticated clustering techniques with retail customer data and comparing further with prediction models</h2>
<p>Clustering is a fundamental technique in machine learning that involves grouping data points so that the objects in the same group (or cluster) are more similar to each other than to those in other groups. It’s a form of unsupervised learning, as the groups are not predefined but rather determined by the algorithm itself. This approach is particularly useful in understanding the structure within data, identifying patterns, and making strategic decisions.</p>
<p>In this blog, we will explore how to apply clustering techniques to a customer dataset. Our dataset contains customer information with attributes like Customer ID, Age, Annual Income, and Spending Score. The goal is to segment customers into distinct groups based on these features, which can help in tailoring marketing strategies, understanding customer behavior, and improving customer service.</p>
<p><strong>Introduction</strong></p>
<p><strong>Data Loading and Basic Visualization</strong></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importing libraries</span></span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.cluster <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> KMeans</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StandardScaler</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the dataset</span></span>
<span id="cb1-9">customer_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'clusteringCustomerData.csv'</span>)</span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(customer_df.head())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   CustomerID  Age  Annual_Income  Spending_Score
0           1   62             75              81
1           2   65             76              23
2           3   18             98              80
3           4   21             48              90
4           5   21             47               9</code></pre>
</div>
</div>
<p><strong>Exploring Data Analysis</strong></p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Visualize the distributions and relationships between features.</span></span>
<span id="cb3-2">sns.pairplot(customer_df.drop(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CustomerID'</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb3-3">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-3-output-1.png" width="711" height="711"></p>
</div>
</div>
<p><strong>Data Preprocessing</strong></p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Encoding categorical data and scaling features.</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Standardize the data.</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Selecting features to be scaled</span></span>
<span id="cb4-4">features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> customer_df[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Age'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Annual_Income'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Spending_Score'</span>]]</span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Standardizing the features</span></span>
<span id="cb4-7">scaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StandardScaler()</span>
<span id="cb4-8">scaled_features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaler.fit_transform(features)</span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Converting scaled features back to a DataFrame</span></span>
<span id="cb4-11">scaled_features_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(scaled_features, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>features.columns)</span>
<span id="cb4-12"></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Displaying the first few rows of the scaled data</span></span>
<span id="cb4-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(scaled_features_df.head())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Age  Annual_Income  Spending_Score
0  1.237684       0.746278        0.901945
1  1.428146       0.788416       -1.020966
2 -1.555756       1.715469        0.868791
3 -1.365294      -0.391469        1.200327
4 -1.365294      -0.433608       -1.485117</code></pre>
</div>
</div>
<p><strong>Exploratory Data Analysis (EDA)</strong></p>
<p>Beyond basic visualizations, we’ll use EDA to understand the data distributions and potential relationships.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizing the distribution of features</span></span>
<span id="cb6-2">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb6-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, col <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Age'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Annual_Income'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Spending_Score'</span>]):</span>
<span id="cb6-4">    plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-5">    sns.histplot(customer_df[col], kde<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb6-6">    plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Distribution of </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>col<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb6-7">plt.tight_layout()</span>
<span id="cb6-8">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-5-output-1.png" width="1141" height="374"></p>
</div>
</div>
</section>
<section id="advanced-clustering-with-multiple-techniques" class="level2">
<h2 class="anchored" data-anchor-id="advanced-clustering-with-multiple-techniques">Advanced Clustering with Multiple Techniques</h2>
<p>We’ll explore different clustering algorithms beyond K-Means, such as Hierarchical Clustering and DBSCAN, to understand how they segment the data differently.</p>
</section>
<section id="k-means-clustering" class="level2">
<h2 class="anchored" data-anchor-id="k-means-clustering">1. K-Means Clustering</h2>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Using the Elbow Method to determine the optimal number of clusters.</span></span>
<span id="cb7-2">wcss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb7-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>):</span>
<span id="cb7-4">    kmeans <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> KMeans(n_clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>i, n_init<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb7-5">    kmeans.fit(scaled_features)</span>
<span id="cb7-6">    wcss.append(kmeans.inertia_)</span>
<span id="cb7-7">    customer_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'KMeans_Cluster'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> kmeans.labels_</span>
<span id="cb7-8">plt.plot(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), wcss)</span>
<span id="cb7-9">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'The Elbow Method'</span>)</span>
<span id="cb7-10">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Number of clusters'</span>)</span>
<span id="cb7-11">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'WCSS'</span>)</span>
<span id="cb7-12">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-6-output-1.png" width="593" height="449"></p>
</div>
</div>
<p><strong>Application of K-Means</strong></p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Applying K-Means and visualizing the clusters.</span></span>
<span id="cb8-2">kmeans <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> KMeans(n_clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, n_init<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb8-3">customer_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Cluster'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> kmeans.fit_predict(scaled_features)</span>
<span id="cb8-4">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Annual_Income'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Spending_Score'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Cluster'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>customer_df, palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'viridis'</span>)</span>
<span id="cb8-5">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Customer Segments'</span>)</span>
<span id="cb8-6">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-7-output-1.png" width="593" height="449"></p>
</div>
</div>
<p><strong>K-Means Visualization</strong></p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">sns.pairplot(customer_df, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">vars</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Age'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Annual_Income'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Spending_Score'</span>], hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'KMeans_Cluster'</span>, palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'viridis'</span>)</span>
<span id="cb9-2">plt.suptitle(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'K-Means Clustering'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.02</span>)</span>
<span id="cb9-3">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-8-output-1.png" width="834" height="740"></p>
</div>
</div>
</section>
<section id="dbscan-clustering" class="level2">
<h2 class="anchored" data-anchor-id="dbscan-clustering">2. DBSCAN clustering</h2>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.cluster <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DBSCAN</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DBSCAN clustering</span></span>
<span id="cb10-4">dbscan <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DBSCAN(eps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, min_samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>).fit(scaled_features_df)</span>
<span id="cb10-5">customer_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DBSCAN_Cluster'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dbscan.labels_</span></code></pre></div>
</div>
<p><strong>Density-Based Spatial Clustering of Applications with Noise (DBSCAN) Visualization</strong></p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizing DBSCAN Clusters</span></span>
<span id="cb11-2">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Annual_Income'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Spending_Score'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DBSCAN_Cluster'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>customer_df, palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'viridis'</span>)</span>
<span id="cb11-3">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DBSCAN Clustering'</span>)</span>
<span id="cb11-4">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-10-output-1.png" width="593" height="449"></p>
</div>
</div>
</section>
<section id="hierarchical-cluster-visualization" class="level2">
<h2 class="anchored" data-anchor-id="hierarchical-cluster-visualization">3. Hierarchical Cluster Visualization</h2>
<p>Visualize the clusters formed by each algorithm in multiple dimensions to gain deeper insights.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.cluster.hierarchy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dendrogram, linkage</span>
<span id="cb12-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.cluster <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AgglomerativeClustering  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import AgglomerativeClustering</span></span>
<span id="cb12-3"></span>
<span id="cb12-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Performing Hierarchical Clustering</span></span>
<span id="cb12-5">linked <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> linkage(scaled_features_df, method<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ward'</span>)</span>
<span id="cb12-6"></span>
<span id="cb12-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting the Dendrogram</span></span>
<span id="cb12-8">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb12-9">dendrogram(linked, orientation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>, distance_sort<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'descending'</span>, show_leaf_counts<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb12-10">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hierarchical Clustering Dendrogram'</span>)</span>
<span id="cb12-11">plt.show()</span>
<span id="cb12-12"></span>
<span id="cb12-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform hierarchical clustering and add the cluster labels to customer_df</span></span>
<span id="cb12-14">clustering <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AgglomerativeClustering(n_clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Specify the number of clusters</span></span>
<span id="cb12-15">customer_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hierarchical_Cluster'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> clustering.fit_predict(scaled_features_df)</span>
<span id="cb12-16"></span>
<span id="cb12-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hierarchical Clustering Visualization</span></span>
<span id="cb12-18">sns.pairplot(customer_df, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">vars</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Age'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Annual_Income'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Spending_Score'</span>], hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hierarchical_Cluster'</span>, palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'viridis'</span>)</span>
<span id="cb12-19">plt.suptitle(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hierarchical Clustering'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.02</span>)</span>
<span id="cb12-20">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-11-output-1.png" width="804" height="579"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-11-output-2.png" width="862" height="740"></p>
</div>
</div>
<p><strong>Hierarchical Clustering Cut</strong></p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.cluster.hierarchy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> fcluster</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cutting the Dendrogram to form clusters</span></span>
<span id="cb13-4">customer_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hierarchical_Cluster'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fcluster(linked, t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, criterion<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'maxclust'</span>)</span>
<span id="cb13-5"></span>
<span id="cb13-6">sns.scatterplot(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>customer_df, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Annual_Income'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Spending_Score'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hierarchical_Cluster'</span>, palette<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'viridis'</span>)</span>
<span id="cb13-7">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hierarchical Clustering'</span>)</span>
<span id="cb13-8">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-12-output-1.png" width="593" height="449"></p>
</div>
</div>
</section>
<section id="silhouette-analysis-for-k-means-and-hierarchical-clustering" class="level2">
<h2 class="anchored" data-anchor-id="silhouette-analysis-for-k-means-and-hierarchical-clustering">Silhouette Analysis for K-means and Hierarchical Clustering</h2>
<p><strong>1. K-Means Clustering</strong></p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.metrics <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> silhouette_samples, silhouette_score</span>
<span id="cb14-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb14-3"></span>
<span id="cb14-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate silhouette scores for different cluster numbers</span></span>
<span id="cb14-5">silhouette_scores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb14-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> n_clusters <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>):</span>
<span id="cb14-7">    kmeans <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> KMeans(n_clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_clusters, n_init<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb14-8">    cluster_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> kmeans.fit_predict(scaled_features)</span>
<span id="cb14-9">    silhouette_avg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> silhouette_score(scaled_features, cluster_labels)</span>
<span id="cb14-10">    silhouette_scores.append(silhouette_avg)</span>
<span id="cb14-11"></span>
<span id="cb14-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot silhouette scores</span></span>
<span id="cb14-13">plt.plot(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), silhouette_scores, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o'</span>)</span>
<span id="cb14-14">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Silhouette Analysis for K-Means'</span>)</span>
<span id="cb14-15">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Number of clusters'</span>)</span>
<span id="cb14-16">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Silhouette Score'</span>)</span>
<span id="cb14-17">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-13-output-1.png" width="597" height="449"></p>
</div>
</div>
<p><strong>2. Hierarchical Clustering</strong></p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.cluster <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AgglomerativeClustering</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate silhouette scores for different cluster numbers in hierarchical clustering</span></span>
<span id="cb15-4">silhouette_scores_hierarchical <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb15-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> n_clusters <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>):</span>
<span id="cb15-6">    hierarchical <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AgglomerativeClustering(n_clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_clusters)</span>
<span id="cb15-7">    cluster_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> hierarchical.fit_predict(scaled_features)</span>
<span id="cb15-8">    silhouette_avg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> silhouette_score(scaled_features, cluster_labels)</span>
<span id="cb15-9">    silhouette_scores_hierarchical.append(silhouette_avg)</span>
<span id="cb15-10"></span>
<span id="cb15-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot silhouette scores for hierarchical clustering</span></span>
<span id="cb15-12">plt.plot(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>), silhouette_scores_hierarchical, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o'</span>)</span>
<span id="cb15-13">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Silhouette Analysis for Hierarchical Clustering'</span>)</span>
<span id="cb15-14">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Number of clusters'</span>)</span>
<span id="cb15-15">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Silhouette Score'</span>)</span>
<span id="cb15-16">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Clustering/index_files/figure-html/cell-14-output-1.png" width="606" height="449"></p>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>#In this in-depth analysis, we have explored different clustering techniques and visualized their results to segment customers in a comprehensive manner. Each method offers unique insights: K-Means provides clear segmentations, Hierarchical Clustering helps us understand the data structure, and DBSCAN identifies core and outlier points effectively.</p>
<p>By comparing these methods, we can choose the one that best suits our specific needs for customer segmentation. This advanced clustering analysis can guide strategic decisions, improve customer engagement, and enhance targeting in marketing campaigns.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>machine learning</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/Clustering/index.html</guid>
  <pubDate>Fri, 24 Nov 2023 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/Clustering/image1.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Git</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/git/git.html</link>
  <description><![CDATA[ 



<p><a href="https://en.wikipedia.org/wiki/Git#:~:text=Git%20(/%C9%A1%C9%AAt/)%5B8%5D%20is%20a%20distributed%20version%20control%20system%5B9%5D%20that%20tracks%20changes%20in%20any%20set%20of%20computer%20files%2C%20usually%20used%20for%20coordinating%20work%20among%20programmers%20who%20are%20collaboratively%20developing%20source%20code%20during%20software%20development.">Git</a> is a <a href="https://en.wikipedia.org/wiki/Version_control#:~:text=version%20control%20(also%20known%20as%20revision%20control%2C%20source%20control%2C%20or%20source%20code%20management)%20is%20a%20class%20of%20systems%20responsible%20for%20managing%20changes%20to%20computer%20programs%2C%20documents%2C%20large%20web%20sites%2C%20or%20other%20collections%20of%20information.">version control</a> system created by <a href="https://en.wikipedia.org/wiki/Linus_Torvalds#:~:text=Linus%20Benedict%20Torvalds%20(,control%20system%20Git.)">Linus Torvalds</a>, who is also the creator of <a href="https://en.wikipedia.org/wiki/Linux#:~:text=Linux%20(/%CB%88l%C9%AAn%CA%8Aks/%20LIN%2Duuks)%5B11%5D%20is%20a%20family%20of%20open%2Dsource%20Unix%2Dlike%20operating%20systems%20based%20on%20the%20Linux%20kernel%2C%5B12%5D%20an%20operating%20system%20kernel%20first%20released%20on%20September%2017%2C%201991%2C%20by%20Linus%20Torvalds.">Linux</a>. Since its first release, Git has largely replaced other version control systems and is used by 93% of <a href="https://en.wikipedia.org/wiki/Software#:~:text=Software%20is%20a%20set%20of%20computer%20programs%20and%20associated%20documentation%20and%20data.">software</a> developers worldwide, according to <a href="https://stackoverflow.blog/2023/01/09/beyond-git-the-other-version-control-systems-developers-use/#:~:text=Our%20developer%20survey%20found%2093%25%20of%20developers%20use%20Git.">survey results</a> published by <a href="https://stackoverflow.com/tour">StackOverflow</a>.</p>
<p>Thanks to Git, I can sleep💤soundly at night, reassured by the knowledge that all of my progress on all of my ongoing project is recorded. My progress is not only stored on my local computer, but also on <a href="https://en.wikipedia.org/wiki/Git#:~:text=Git%20repository%20services%2C%20including%20GitHub%2C%20SourceForge%2C%20Bitbucket%20and%20GitLab.%5B">Git repository hosting services</a> such as <a href="https://en.wikipedia.org/wiki/GitHub#:~:text=GitHub%2C%20Inc.%20(/%CB%88%C9%A1%C9%AAth%CA%8Cb/%5Ba%5D)%20is%20a%20platform%20and%20cloud%2Dbased%20service%20for%20software%20development%20and%20version%20control%2C%20allowing%20developers%20to%20store%20and%20manage%20their%20code.">GitHub</a> and <a href="https://en.wikipedia.org/wiki/GitLab">GitLab</a>.</p>
<p>A Git <a href="https://en.wikipedia.org/wiki/Repository_(version_control)#:~:text=In%20version%20control%20systems%2C%20a%20repository%20is%20a%20data%20structure%20that%20stores%20metadata%20for%20a%20set%20of%20files%20or%20directory%20structure.">repository</a> (repo) is a <a href="https://en.wikipedia.org/wiki/Directory_(computing)#:~:text=a%20directory%20is%20a%20file%20system%20cataloging%20structure%20which%20contains%20references%20to%20other%20computer%20files%2C%20and%20possibly%20other%20directories.">directory</a> that tracks the changes made to its contents. For more information on GitHub, the largest Git repo host, take a look at the <a href="https://openscapes.org/blog/2022-05-27-github-illustrated-series/">“GitHub for supporting, reusing, contributing, and failing safely”</a> post by <a href="https://allisonhorst.com">Allison Horst</a> and <a href="https://jules32.github.io">Julie Lowndes</a> on the <a href="https://openscapes.org/">Openscapes</a> <a href="https://openscapes.org/blog">blog</a>.</p>
<p>GitHub and GitLab do not only host repos, but also websites via <a href="https://quarto.org/docs/publishing/github-pages.html#render-to-docs">GitHub Pages</a> and <a href="https://docs.gitlab.com/ee/user/project/pages/">GitLab Pages</a>. My personal site is hosted for free on both <a href="https://maptv.github.io">GitHub Pages</a> and <a href="https://maptv.gitlab.io">GitLab Pages</a>.</p>
<p>Before you can benefit from everything GitHub and/or GitLab have to offer, you will need to set up your computer so that you can work locally and/or configure a service like <a href="https://github.com/features/codespaces">GitHub Codespaces</a> or <a href="https://docs.gitlab.com/ee/user/project/web_ide">GitLab Web IDE</a> so you can work remotely in your <a href="https://en.wikipedia.org/wiki/Web_browser#:~:text=A%20web%20browser%20is%20an%20application%20for%20accessing%20websites%20and%20the%20Internet.%5B">web browser</a>. In this post, I discuss local development environment setup with the <a href="https://brew.sh">Homebrew</a> <a href="https://en.wikipedia.org/wiki/Package_manager#:~:text=A%20package%20manager%20or%20package%2Dmanagement%20system%20is%20a%20collection%20of%20software%20tools%20that%20automates%20the%20process%20of%20installing%2C%20upgrading%2C%20configuring%2C%20and%20removing%20computer%20programs%20for%20a%20computer%20in%20a%20consistent%20manner.">package manager</a> and repo setup with the GitHub and GitLab CLI.</p>
<p>If you follow along to end of this post, you will have a repo called <code>dotfiles</code> that can be used for Codespaces setup.</p>
<section id="sec-setup" class="level2">
<h2 class="anchored" data-anchor-id="sec-setup">Setup</h2>
<section id="sec-setup-brew" class="level3">
<h3 class="anchored" data-anchor-id="sec-setup-brew">Homebrew</h3>
<p><a href="https://en.wikipedia.org/wiki/Linux#:~:text=Linux%20(/%CB%88l%C9%AAn%CA%8Aks/%20LIN%2Duuks)%5B11%5D%20is%20a%20family%20of%20open%2Dsource%20Unix%2Dlike%20operating%20systems">Linux</a>, <a href="https://en.wikipedia.org/wiki/MacOS#:~:text=macOS%20(/%CB%8Cm%C3%A6ko%CA%8A%CB%88%C9%9Bs/%3B%5B6%5D%20previously%20OS%C2%A0X%20and%20originally%20Mac%C2%A0OS%C2%A0X)%20is%20an%20operating%20system%20developed%20and%20marketed%20by%20Apple%20Inc.%20since%202001.">macOS</a>, or <a href="https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux#:~:text=Windows%20Subsystem%20for%20Linux%20(WSL)%20is%20a%20feature%20of%20Windows%20that%20allows%20developers%20to%20run%20a%20Linux%20environment%20without%20the%20need%20for%20a%20separate%20virtual%20machine%20or%20dual%20booting.">Windows Subsystem for Linux</a> (WSL) users can use Homebrew to install everything needed to work through all of the examples in this blog post. First, <a href="https://brew.sh/#install">install Homebrew</a> itself with the latest <a href="https://github.com/Homebrew/brew/releases"><code>.pkg</code> installer</a> for macOS or by running the Example&nbsp;1 <a href="https://en.wikipedia.org/wiki/Unix#:~:text=Unix%20(/%CB%88ju%CB%90n%C9%AAks/%2C%20YOO%2Dniks%3B%20trademarked%20as%20UNIX)%20is%20a%20family%20of%20multitasking%2C%20multi%2Duser%20computer%20operating%20systems">Unix</a> <a href="https://en.wikipedia.org/wiki/Unix_shell#:~:text=A%20Unix%20shell%20is%20a%20command%2Dline%20interpreter%20or%20shell%20that%20provides%20a%20command%20line%20user%20interface%20for%20Unix%2Dlike%20operating%20systems.">shell</a> code in your <a href="https://en.wikipedia.org/wiki/Terminal_emulator#:~:text=A%20terminal%20emulator%2C%20or%20terminal%20application%2C%20is%20a%20computer%20program%20that%20emulates%20a%20video%20terminal%20within%20some%20other%20display%20architecture.">terminal</a>.</p>
<div id="exm-brew" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 </strong></span>&nbsp;</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/bin/bash</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fsSL</span> https://<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">raw.githubusercontent.com/Homebrew/<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3">install/HEAD/install.sh<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<p>If you are not completely satisfied with the integrated terminal built into your preferred <a href="https://en.wikipedia.org/wiki/Source-code_editor#:~:text=A%20source%2Dcode%20editor%20is%20a%20text%20editor%20program%20designed%20specifically%20for%20editing%20source%20code%20of%20computer%20programs.">source-code editor</a> or the standalone terminal that comes with your <a href="https://en.wikipedia.org/wiki/Operating_system#:~:text=An%20operating%20system%20(OS)%20is%20system%20software%20that%20manages%20computer%20hardware%20and%20software%20resources%2C%20and%20provides%20common%20services%20for%20computer%20programs.">operating system</a> (OS), you can use Homebrew to install a new one. The standalone terminal I use most often is <a href="https://formulae.brew.sh/cask/iterm2#default">iTerm2</a>, which is only for macOS, but I also have the following multi-OS terminals: <a href="https://formulae.brew.sh/cask/alacritty#default">Alacritty</a>, <a href="https://formulae.brew.sh/cask/hyper#default">Hyper</a>, <a href="https://formulae.brew.sh/cask/kitty#default">Kitty</a>, and <a href="https://formulae.brew.sh/cask/tabby#default">Tabby</a>.</p>
<p>After installing Homebrew, you can run <code>brew</code> <code>doctor</code> in your terminal to confirm that everything is set up correctly. If the <code>brew</code> command is not available, you need to follow the instructions provided after installation to add <code>brew</code> to your <a href="https://en.wikipedia.org/wiki/PATH_(variable)#:~:text=PATH%20is%20an%20environment%20variable%20on%20Unix%2Dlike%20operating%20systems%2C%20DOS%2C%20OS/2%2C%20and%20Microsoft%20Windows%2C%20specifying%20a%20set%20of%20directories%20where%20executable%20programs%20are%20located.">PATH variable</a>.</p>
<p>Once Homebrew is ready, you can run the shell code in Example&nbsp;2 to create a file called <code>Brewfile</code> with the <a href="https://en.wikipedia.org/wiki/Echo_(command)#:~:text=echo%20is%20a%20command%20that%20outputs%20the%20strings%20that%20are%20passed%20to%20it%20as%20arguments."><code>echo</code></a> shell command and install everything listed in this newly created <a href="https://homebrew-file.readthedocs.io/en/latest/usage.html"><code>Brewfile</code></a> with the <code>brew</code> <code>bundle</code> shell command.</p>
<div id="exm-echo" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 </strong></span>&nbsp;</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'brew "gh"\nbrew "git"</span></span>
<span id="cb2-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">brew "glab"\ncask "github"'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> Brewfile</span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">brew</span> bundle</span></code></pre></div>
</div>
<p>The <code>Brewfile</code> created by the shell code in Example&nbsp;2 installs:</p>
<ul>
<li>Git,</li>
<li>the <a href="https://en.wikipedia.org/wiki/Command-line_interface#:~:text=A%20command%2Dline%20interface%20(CLI)%20is%20a%20means%20of%20interacting%20with%20a%20computer%20program%20by%20inputting%20lines%20of%20text%20called%20command%2Dlines.">command line interfaces</a> (CLIs) for
<ul>
<li><a href="https://cli.github.com">GitHub</a> and</li>
<li><a href="https://docs.gitlab.com/ee/editor_extensions/gitlab_cli/">GitLab</a>, and</li>
</ul></li>
<li>the <a href="https://git-scm.com/downloads/guis#:~:text=iOS-,GitHub%20Desktop,-Platforms%3A%20Mac">GitHub Desktop</a> Git <a href="https://en.wikipedia.org/wiki/Graphical_user_interface#:~:text=A%20graphical%20user%20interface%2C%20or%20GUI%20(/%CB%88%C9%A1u%CB%90i/%5B1%5D%5B2%5D%20GOO%2Dee)%2C%20is%20a%20form%20of%20user%20interface%20that%20allows%20users%20to%20interact%20with%20electronic%20devices%20through%20graphical%20icons%20and%20audio%20indicators%20such%20as%20primary%20notation.">Graphical User Interface</a> (GUI).</li>
</ul>
<p>If you are curious about how I set up my computer, you can take a look at my <a href="https://github.com/maptv/setup/blob/main/Brewfile"><code>Brewfile</code></a> and other configuration files in my <code>setup</code> repo on <a href="https://github.com/maptv/setup">GitHub</a> and <a href="https://gitlab.com/maptv/setup">GitLab</a>. I will highlight a few configuration files in Section&nbsp;2.</p>
</section>
<section id="sec-setup-repo" class="level3">
<h3 class="anchored" data-anchor-id="sec-setup-repo">Repository</h3>
<p>Before we get started, you will need a <a href="https://github.com/signup">GitHub</a> and/or <a href="https://gitlab.com/users/sign_up">GitLab</a> account and a way to authenticate into your account(s).</p>
<p>Of the many <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/about-authentication-to-github#about-authentication-to-github">authentication methods</a>, passkeys stand out because they can function as both a password and <a href="https://en.wikipedia.org/wiki/Multi-factor_authentication#:~:text=two%2Dfactor%20authentication%2C%20or%202FA%2C%20along%20with%20similar%20terms">two-factor authentication</a>%20is%20an%20electronic%20authentication%20method%20in%20which%20a%20user%20is%20granted%20access%20to%20a%20website%20or%20application%20only%20after%20successfully%20presenting%20two%20or%20more%20pieces%20of%20evidence%20(or%20factors)%20to%20an%20authentication%20mechanism.) (2FA), thus combining the two steps in the 2FA sign-in process into one. Passkeys will certaily GitHub recently announced its plan to make <a href="https://github.blog/2023-03-09-raising-the-bar-for-software-security-github-2fa-begins-march-13">2FA mandatory</a> for code contributors, which will make passkeys . <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account#about-addition-of-ssh-keys-to-your-account">SSH key</a>.</p>
<p>satisfy both requirements, including SSH keys are still the easiest way to authenticate to GitHub and GitLab in my honest opinion.</p>
<p>You can create a repo using the web interface of <a href="https://github.com" class="uri">https://github.com</a> or <a href="https://gitlab.com" class="uri">https://gitlab.com</a> in your browser, but the best way to start a new project is using the CLI for <a href="https://cli.github.com">GitHub</a> or <a href="https://docs.gitlab.com/ee/editor_extensions/gitlab_cli/">GitLab</a> in your <a href="https://en.wikipedia.org/wiki/Terminal_emulator">terminal</a>. First, run <code>gh</code> <code>auth</code> <code>login</code> or <code>glab</code> <code>auth</code> <code>login</code> and follow the prompts to authenticate via your web browser or with an <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens">authentication token</a>.</p>
<p>The GitHub CLI allows you to add an SSH key to your account during or <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account?tool=cli#adding-a-new-ssh-key-to-your-account">after authentication</a>. The GitLab CLI does not handle SSH keys during authentication, but has a similar command for <a href="https://gitlab.com/gitlab-org/cli/-/blob/main/docs/source/ssh-key/add.md">adding an SSH key to your GitLab account</a>.</p>
<p>After authentication and SSH key setup, you can run the code in either of the code chunks in Example&nbsp;3 to set up your local and remote repos and create a Quarto website project in the local repo. You can create shell alias that combine all of the repo creation steps like I did in my <a href="https://github.com/maptv/setup/blob/0bd5898908974746fa55e7e8f19a36859040b6ca/.zshrc#L630"><code>.zshrc</code></a>.</p>
<div id="exm-git" class="theorem example">
<p><span class="theorem-title"><strong>Example 3 </strong></span>&nbsp;</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">GitHub</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">GitLab</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># start in home directory</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> USERNAME</span>
<span id="cb3-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> USERNAME</span>
<span id="cb3-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gh</span> repo create REPONAME <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--add-readme</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--clone</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--public</span></span>
<span id="cb3-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> REPONAME</span></code></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># start in home directory</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> USERNAME</span>
<span id="cb4-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> USERNAME</span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">glab</span> repo create REPONAME <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--readme</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--defaultBranch</span> main <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--public</span></span>
<span id="cb4-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> REPONAME</span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> pull origin main</span>
<span id="cb4-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> branch <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--set-upstream-to</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>origin/main main</span></code></pre></div>
</div>
</div>
</div>
</div>
<p>To make it easier to backup my repos on both GitHub and GitLab, I set up each local repo to have two <code>origin</code> remote URLs using the code as shown in Example&nbsp;4. With this setting, running <code>git</code> <code>push</code> in my local repo updates my remote repos on both GitHub and GitLab.</p>
<div id="exm-remote" class="theorem example">
<p><span class="theorem-title"><strong>Example 4 </strong></span>&nbsp;</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> remote add lab git@gitlab.com:maptv/maptv.gitlab.io</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> remote add hub git@github.com:maptv/maptv.github.io</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> remote set-url <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--add</span> origin <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> remote get-url lab<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
</section>
</section>
<section id="sec-workflow" class="level2">
<h2 class="anchored" data-anchor-id="sec-workflow">Git workflow</h2>
<p>When I want to add or update the content on my site, I go through the steps in the standard Git workflow shown in Figure&nbsp;1. Every time I “push” a collection of changes called a <a href="https://en.wikipedia.org/wiki/Commit_(version_control)#:~:text=In%20version%20control%20systems%2C%20a%20commit%20is%20an%20operation%20which%20sends%20the%20latest%20changes%20of%20the%20source%20code%20to%20the%20repository%2C%20making%20these%20changes%20part%20of%20the%20head%20revision%20of%20the%20repository.">commit</a> to my <a href="https://github.com/NishantBharali">GitHub</a> repo on GitHub, a <a href="https://en.wikipedia.org/wiki/Continuous_integration#:~:text=In%20software%20engineering%2C%20continuous%20integration%20(CI)%20is%20the%20practice%20of%20merging%20all%20developers%27%20working%20copies%20to%20a%20shared%20mainline%20several%20times%20a%20day.">continuous integration</a> (CI) system called <a href="https://docs.github.com/en/actions">GitHub Actions</a> automatically completes the steps required to build and publish my website.</p>
<div class="cell" data-fig-width="9" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb6-1">flowchart LR</span>
<span id="cb6-2">   A[working&lt;br/&gt;directory]-.git&lt;br/&gt;add.-&gt;B{{staging&lt;br/&gt;area}}-.git&lt;br/&gt;commit.-&gt;C([local&lt;br/&gt;repo])-.git&lt;br/&gt;push.-&gt;D(remote&lt;br/&gt;repo)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-git" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div>
<pre class="mermaid mermaid-js" data-label="fig-git">flowchart LR
   A[working&lt;br/&gt;directory]-.git&lt;br/&gt;add.-&gt;B{{staging&lt;br/&gt;area}}-.git&lt;br/&gt;commit.-&gt;C([local&lt;br/&gt;repo])-.git&lt;br/&gt;push.-&gt;D(remote&lt;br/&gt;repo)
</pre>
</div>
<figcaption class="figure-caption">Figure&nbsp;1: Git workflow</figcaption>
</figure>
</div>
</div>
</div>
<section id="sec-workflow-alias" class="level3">
<h3 class="anchored" data-anchor-id="sec-workflow-alias">Shell aliases</h3>
<p>To make it easier to make incremental changes to my website and frequently release new content, I combined all of the <code>git</code> shell commands in Figure&nbsp;1 into shell <a href="https://en.wikipedia.org/wiki/Alias_(command)#:~:text=In%20computing%2C%20alias%20is%20a%20command%20in%20various%20command%2Dline%20interpreters%20(shells)%2C%20which%20enables%20a%20replacement%20of%20a%20word%20by%20another%20string.">aliases</a>. You can add shell aliases to a <a href="https://en.wikipedia.org/wiki/Unix_shell#:~:text=The%20%22rc%22%20suffix%20on%20some%20Unix%20configuration%20files%20(for%20example%2C%20%22.vimrc%22)%2C%20is%20a%20remnant%20of%20the%20RUNCOM%20ancestry%20of%20Unix%20shells.">shell configuration file</a> like <code>.bashrc</code> or <code>.zshrc</code> on your computer to shorten one or more commands and any associated command <a href="https://en.wikipedia.org/wiki/Command-line_interface#Arguments:~:text=A%20command%2Dline%20argument%20or%20parameter%20is%20an%20item%20of%20information%20provided%20to%20a%20program%20when%20it%20is%20started.">arguments</a>.</p>
<p>The <code>git</code> <code>commit</code> aliases in the <code>.zshrc</code> file in my <code>setup</code> repo on <a href="https://github.com/maptv/setup">GitHub</a> and <a href="https://gitlab.com/maptv/setup">GitLab</a> target different groups of files for inclusion in the next commit. For example, <code>cmp</code> targets <a href="https://git-scm.com/book/en/v2/Getting-Started-What-is-Git%3F#:~:text=Staged%20means%20that%20you%20have%20marked%20a%20modified%20file%20in%20its%20current%20version%20to%20go%20into%20your%20next%20commit%20snapshot.">staged</a> files, <code>camp</code> targets <a href="https://git-scm.com/book/en/v2/Git-Basics-Recording-Changes-to-the-Repository#:~:text=Tracked%20files%20are%20files%20that%20were%20in%20the%20last%20snapshot%2C%20as%20well%20as%20any%20newly%20staged%20files">tracked</a> files, <code>a.cmp</code> targets files in the current directory, and <code>aacmp</code> targets files in the repo.</p>
<p>Example&nbsp;5 shows the <code>aacmp</code> alias as an example of the shell alias syntax. The mnemonic device for this alias is <strong>a</strong>dd <strong>a</strong>ll, <strong>c</strong>ommit with a <strong>m</strong>essage, and <strong>p</strong>ush.</p>
<div id="exm-alias" class="theorem example">
<p><span class="theorem-title"><strong>Example 5 </strong></span>&nbsp;</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>.zshrc</strong></pre>
</div>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">alias</span> aacmp=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"func() { git add --all &amp;&amp; git commit --message </span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'${*:-$(echo $(git diff --name-status --cached \</span></span>
<span id="cb7-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    | tr "[:space:]" " "))}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> &amp;&amp; git push; }; func"</span></span></code></pre></div>
</div>
</div>
<p>Aliases like <code>aacmp</code> allow me to enter free-form <a href="https://en.wikipedia.org/wiki/Commit_(version_control)#:~:text=git%20commit%20%2Dm%20%27-,commit%20message,-%27">commit messages</a> directly on the command line without quotes, e.g.&nbsp;<code>aacmp</code> <code>edit</code> <code>first</code> <code>post</code>. If you decide to try one of these aliases, please exercise extreme caution as any un-<a href="https://en.wikipedia.org/wiki/Escape_character#:~:text=an%20escape%20character%20is%20a%20character%20that%20invokes%20an%20alternative%20interpretation%20on%20the%20following%20characters%20in%20a%20character%20sequence.">escaped</a> or un-quoted <a href="https://en.wikipedia.org/wiki/Metacharacter#:~:text=A%20metacharacter%20is%20a%20character%20that%20has%20a%20special%20meaning%20to%20a%20computer%20program%2C%20such%20as%20a%20shell%20interpreter">metacharacters</a> may yield surprising effects instead of being included verbatim in the commit message, e.g.&nbsp;<code>*</code> is replaced by all of the file and directory names in the current directory!</p>
<p>If no commit message is provided after the aliases, a generic commit message is created that includes the <a href="https://git-scm.com/docs/git-diff#Documentation/git-diff.txt---diff-filterACDMRTUXB82308203">change type</a> and name of each changed file. In Section&nbsp;2.2, I describe how I used this generic commit message approach to further simplify the Git workflow.</p>
</section>
<section id="sec-workflow-key" class="level3">
<h3 class="anchored" data-anchor-id="sec-workflow-key">Keybindings</h3>
<p>An alternative to a shell alias that combines <code>git</code> commands is to use a keyboard shortcut in a <a href="https://git-scm.com/downloads/guis#:~:text=iOS-,GitHub%20Desktop,-Platforms%3A%20Mac">Git Graphical User Interface (GUI)</a> such as <a href="https://desktop.github.com"><code>GitHub Desktop</code></a> or the Git interface in a <a href="https://en.wikipedia.org/wiki/Source-code_editor#:~:text=A%20source%2Dcode%20editor%20is%20a%20text%20editor%20program%20designed%20specifically%20for%20editing%20source%20code%20of%20computer%20programs.">code editor</a> like VSCode, VSCodium, or RStudio. I use keyboard shortcuts in VSCode and VSCodium to send shell commands to the integrated terminal without moving my focus away from the files I am editing.</p>
<p>I created different shortcuts to control which files are included in each commit: ⌥⇧F for the current file only, ⌥⇧S for already <a href="https://git-scm.com/book/en/v2/Getting-Started-What-is-Git%3F#:~:text=Staged%20means%20that%20you%20have%20marked%20a%20modified%20file%20in%20its%20current%20version%20to%20go%20into%20your%20next%20commit%20snapshot.">staged</a> files, ⌥⇧T for all <a href="https://git-scm.com/book/en/v2/Git-Basics-Recording-Changes-to-the-Repository#:~:text=Tracked%20files%20are%20files%20that%20were%20in%20the%20last%20snapshot%2C%20as%20well%20as%20any%20newly%20staged%20files">tracked files</a>, and ⌥⇧U for all files including <a href="https://git-scm.com/book/en/v2/Git-Basics-Recording-Changes-to-the-Repository#:~:text=Untracked%20files%20are%20everything%20else%E2%80%89%E2%80%94%E2%80%89any%20files%20in%20your%20working%20directory%20that%20were%20not%20in%20your%20last%20snapshot%20and%20are%20not%20in%20your%20staging%20area.">untracked files</a>. I also have keyboard shortcuts that affect a specific directory (and all of its subdirectories): ⌥⇧D for the current file’s directory, ⌥⇧. for shell’s current directory, ⌥⇧C for the current working directory according to VSCode/VSCodium, ⌥⇧W for the <a href="https://code.visualstudio.com/docs/editor/workspaces#:~:text=A%20Visual%20Studio%20Code%20%22workspace%22%20is%20the%20collection%20of%20one%20or%20more%20folders%20that%20are%20opened%20in%20a%20VS%20Code%20window">Workspace</a> directory.</p>
<p>Example&nbsp;6 displays the ⌥⇧F shortcut as an example of the VSCode/VSCodium shortcut syntax. This shortcut uses the <a href="https://en.wikipedia.org/wiki/ANSI_escape_code#C0_control_codes">escape code</a> for the <a href="https://en.wikipedia.org/wiki/ANSI_escape_code#C0_control_codes:~:text=0x0D,Carriage%20Return">return key</a> (<code>\u000D</code>) to run several <code>git</code> commands and <a href="https://code.visualstudio.com/docs/editor/variables-reference#_predefined-variables">predefined variables</a> to insert the absolute (<code>${file}</code>) and relative (<code>${relativeFile}</code>) path to the currently open file.</p>
<div id="exm-key" class="theorem example">
<p><span class="theorem-title"><strong>Example 6 </strong></span>&nbsp;</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>keybindings.json</strong></pre>
</div>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb8-2">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"key"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shift+alt+f"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb8-3">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"command"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"workbench.action.terminal.sendSequence"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"args"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"text"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb8-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"git add ${file} &amp;&amp; git commit -m </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M ${relativeFile}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> &amp;&amp; git push</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\u000D</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">},</span></span>
<span id="cb8-5">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"when"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"terminalIsOpen"</span></span>
<span id="cb8-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
</div>
<p>If you want to set up similar shortcuts for yourself, take a look at <a href="https://github.com/maptv/setup/blob/main/keybindings.json">my keybindings.json</a> in my <code>setup</code> repo on <a href="https://github.com/maptv/setup">GitHub</a> and <a href="https://gitlab.com/maptv/setup">GitLab</a>. As you create keyboard shortcuts, please be mindful of <a href="https://code.visualstudio.com/docs/getstarted/keybindings#_detecting-keybinding-conflicts">keybinding conflicts</a> that may arise.</p>
<p>To set up a keyboard shortcut that runs a series of steps rather than a single line of shell code, I suggest you use the VSCode/VSCodium <a href="https://code.visualstudio.com/docs/editor/tasks">Tasks</a> mechanism, a system designed to <a href="https://en.wikipedia.org/wiki/Build_automation#:~:text=Build%20automation%20is%20the%20process%20of%20automating%20the%20creation%20of%20a%20software%20build">automate</a> <a href="https://en.wikipedia.org/wiki/Software_build#:~:text=In%20software%20development%2C%20a%20build%20is%20the%20process%20of%20converting%20source%20code%20files%20into%20standalone%20software%20artifact(s)%20that%20can%20be%20run%20on%20a%20computer%2C%20or%20the%20result%20of%20doing%20so.">software build</a> tasks. The default keyboard shortcut to run all tasks in a <a href="https://code.visualstudio.com/docs/editor/tasks#_global-tasks:~:text=Workspace%20or%20folder%20specific%20tasks%20are%20configured%20from%20the%20tasks.json%20file%20in%20the%20.vscode%20folder%20for%20a%20workspace.">local</a> or <a href="https://code.visualstudio.com/docs/editor/tasks#_global-tasks">global</a> <code>task.json</code> file is ⌃⇧B on Linux/Windows or ⌘⇧B on Mac (mnemonic: B is for Build), but you can <a href="https://code.visualstudio.com/docs/editor/tasks#_binding-keyboard-shortcuts-to-tasks">bind other shortcuts to specific tasks</a>.</p>
<p>If you use a text editor like <a href="https://en.wikipedia.org/wiki/Vim_(text_editor)#:~:text=Vim%20(/v%C9%AAm/%3B%5B5%5D%20a%20contraction%20of%20Vi%20IMproved)%20is%20a%20free%20and%20open%2Dsource%2C%20screen%2Dbased%20text%20editor%20program.">Vim</a> or <a href="https://en.wikipedia.org/wiki/Emacs#:~:text=Emacs%20/%CB%88i%CB%90m%C3%A6ks/%2C%20originally%20named%20EMACS%20(an%20acronym%20for%20%22Editor%20Macros%22)%2C%5B1%5D%5B2%5D%5B3%5D%20is%20a%20family%20of%20text%20editors%20that%20are%20characterized%20by%20their%20extensibility.">Emacs</a>, you can create keybindings for Vim plugins like <a href="https://github.com/tpope/vim-fugitive">fugitive</a> or Emacs packages like <a href="https://magit.vc/">magit</a> that run through the entire Git workflow. Example&nbsp;7 shows the Vim+fugitive equivalent of my ⌥⇧F VSCode/VSCodium keybinding.</p>
<div id="exm-vim" class="theorem example">
<p><span class="theorem-title"><strong>Example 7 </strong></span>&nbsp;</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>.vimrc</strong></pre>
</div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">nnoremap</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A-S-f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> :Gw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>bar<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>G! commit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"M "</span>%<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>bar<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>G! push<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>CR<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span></code></pre></div>
</div>
</div>
<p>The drawback of my keyboard shortcut approach for the Git workflow is that it produces generic commit messages that are no very informative. Anyone reading the messages will not be able to tell what changes were made and more importantly why the changes were made.</p>
<p>To automatically generate commit messages based on the currently staged changes, we can use a <a href="https://en.wikipedia.org/wiki/Large_language_model#:~:text=A%20large%20language%20model%20(LLM)%20is%20a%20type%20of%20language%20model%20notable%20for%20its%20ability%20to%20achieve%20general%2Dpurpose%20language%20understanding%20and%20generation.">Large Language Model</a> (LLM). <a href="https://en.wikipedia.org/wiki/Generative_artificial_intelligence#:~:text=Generative%20artificial%20intelligence%20(also%20generative%20AI%20or%20GenAI%5B1%5D)%20is%20artificial%20intelligence%20capable%20of%20generating%20text%2C%20images%2C%20or%20other%20media">Generative artificial intelligence</a> models like LLMs tend to be large in size and have atypical computational requirements.</p>
<p>I really enjoy using Git, especially with shell aliases in my terminal and keyboard shortcuts in my favorite text editors. If we ever collaborate on a project together, you can be sure that I will insist on using Git!</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>Tools</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/git/git.html</guid>
  <pubDate>Fri, 24 Nov 2023 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/git/horst_git-hug.png" medium="image" type="image/png" height="51" width="144"/>
</item>
<item>
  <title>Advanced analysis on Linear and Non-Linear Regression models</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/Linear and Non Linear Regression/index.html</link>
  <description><![CDATA[ 



<section id="a-comprehensive-analysis-on-housing-market" class="level2">
<h2 class="anchored" data-anchor-id="a-comprehensive-analysis-on-housing-market">A Comprehensive Analysis on Housing Market</h2>
</section>
<section id="utilizing-linear-and-non-linear-regression-methodologies-for-the-purpose-of-analyzing-trends-within-the-housing-market" class="level2">
<h2 class="anchored" data-anchor-id="utilizing-linear-and-non-linear-regression-methodologies-for-the-purpose-of-analyzing-trends-within-the-housing-market">Utilizing linear and non-linear regression methodologies for the purpose of analyzing trends within the housing market</h2>
<p><strong>Introduction</strong></p>
<p>In machine learning, linear and nonlinear regression are fundamental techniques used to model relationships between variables, such as predicting housing prices based on various features in a dataset.</p>
<p>Linear Regression is a straightforward method that assumes a linear relationship between the input features (e.g., square footage, number of bedrooms) and the target variable (housing price). It aims to find the best-fit line that minimizes the difference between predicted and actual values. Linear regression is interpretable and works well when the relationship is approximately linear.</p>
<p>Nonlinear Regression, on the other hand, allows for more complex relationships. It can capture curves, bends, and nonlinear patterns in the data. This is particularly useful when housing prices may depend on interactions between features or exhibit nonlinear behavior.</p>
<p>The housing dataset you are using provides a rich source of information to apply both linear and nonlinear regression techniques. By utilizing these methods, you can build predictive models that estimate housing prices accurately, taking into account the specific relationships between features and target variables, whether they are linear or nonlinear in nature. These models can guide real estate decisions, investment strategies, and market analyses more effectively, ultimately benefiting both buyers and sellers in the housing market.</p>
<p>We will start by loading the dataset and performing basic preprocessing, including encoding categorical variables and feature scaling.</p>
<p><strong>Exploring the Dataset and Data Preprocessing</strong></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> train_test_split</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StandardScaler, OneHotEncoder</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.impute <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SimpleImputer</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.compose <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ColumnTransformer</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.pipeline <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pipeline</span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> statsmodels.api <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sm</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.linear_model <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LinearRegression</span>
<span id="cb1-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.metrics <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> mean_squared_error, r2_score</span>
<span id="cb1-14"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> cross_val_score</span>
<span id="cb1-15"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.ensemble <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RandomForestRegressor</span>
<span id="cb1-16"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> GridSearchCV</span>
<span id="cb1-17"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PolynomialFeatures</span>
<span id="cb1-18"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> learning_curve</span>
<span id="cb1-19"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.ensemble <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> GradientBoostingRegressor</span>
<span id="cb1-20"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.svm <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SVR</span>
<span id="cb1-21"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.neural_network <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MLPRegressor</span>
<span id="cb1-22"></span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the dataset</span></span>
<span id="cb1-25">housing_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'modified_housing_data.csv'</span>)</span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling missing values if any</span></span>
<span id="cb1-28">imputer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SimpleImputer(strategy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mean'</span>)</span>
<span id="cb1-29">housing_df[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Size'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GardenArea'</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> imputer.fit_transform(housing_df[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Size'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GardenArea'</span>]])</span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># One-hot encoding and Scaling</span></span>
<span id="cb1-32">categorical_features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neighborhood'</span>]</span>
<span id="cb1-33">numerical_features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Size'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Bedrooms'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Bathrooms'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Age'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GarageSize'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GardenArea'</span>]</span>
<span id="cb1-34"></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create transformers</span></span>
<span id="cb1-36">one_hot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> OneHotEncoder()</span>
<span id="cb1-37">scaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StandardScaler()</span>
<span id="cb1-38"></span>
<span id="cb1-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Column transformer</span></span>
<span id="cb1-40">preprocessor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ColumnTransformer(</span>
<span id="cb1-41">    transformers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[</span>
<span id="cb1-42">        (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num'</span>, scaler, numerical_features),</span>
<span id="cb1-43">        (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cat'</span>, one_hot, categorical_features)</span>
<span id="cb1-44">    ])</span>
<span id="cb1-45"></span>
<span id="cb1-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Preprocessing pipeline</span></span>
<span id="cb1-47">prep_pipeline <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pipeline(steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'preprocessor'</span>, preprocessor)])</span>
<span id="cb1-48"></span>
<span id="cb1-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Splitting the data</span></span>
<span id="cb1-50">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> housing_df.drop([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HouseID'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Price'</span>], axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-51">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> housing_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Price'</span>]</span>
<span id="cb1-52">X_train, X_test, y_train, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_test_split(X, y, test_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb1-53"></span>
<span id="cb1-54">X_train_prep <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prep_pipeline.fit_transform(X_train)</span>
<span id="cb1-55">X_test_prep <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prep_pipeline.transform(X_test)</span></code></pre></div>
</div>
<p><strong>Visualizing Market Trend</strong></p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Visualizing the distributions and relationships</span></span>
<span id="cb2-2">sns.pairplot(housing_df)</span>
<span id="cb2-3">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Linear and Non Linear Regression/index_files/figure-html/cell-3-output-1.png" width="1887" height="1887"></p>
</div>
</div>
</section>
<section id="advanced-linear-regression-analysis" class="level2">
<h2 class="anchored" data-anchor-id="advanced-linear-regression-analysis">Advanced Linear Regression Analysis</h2>
<p>For the linear regression model, we’ll include feature importance analysis and cross-validation.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Linear Regression Model</span></span>
<span id="cb3-2">linear_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LinearRegression()</span>
<span id="cb3-3">linear_model.fit(X_train_prep, y_train)</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cross-Validation</span></span>
<span id="cb3-6">cv_scores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cross_val_score(linear_model, X_train_prep, y_train, cv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, scoring<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'neg_mean_squared_error'</span>)</span>
<span id="cb3-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CV MSE for Linear Regression:"</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.mean(cv_scores))</span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Predictions and Evaluation</span></span>
<span id="cb3-10">y_pred_linear <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> linear_model.predict(X_test_prep)</span>
<span id="cb3-11">mse_linear <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred_linear)</span>
<span id="cb3-12">r2_linear <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r2_score(y_test, y_pred_linear)</span>
<span id="cb3-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear Regression Test MSE:"</span>, mse_linear)</span>
<span id="cb3-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear Regression Test R2:"</span>, r2_linear)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CV MSE for Linear Regression: 2618960221.1247973
Linear Regression Test MSE: 2520672652.9396286
Linear Regression Test R2: 0.9111757572070075</code></pre>
</div>
</div>
</section>
<section id="advanced-non-linear-regression-analysis" class="level2">
<h2 class="anchored" data-anchor-id="advanced-non-linear-regression-analysis">Advanced Non-Linear Regression Analysis</h2>
<p>We’ll apply a more complex non-linear model, such as a Random Forest Regressor, and perform hyperparameter tuning using GridSearchCV.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Non-Linear Model - Random Forest Regressor</span></span>
<span id="cb5-2">rf_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RandomForestRegressor(random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hyperparameter Grid</span></span>
<span id="cb5-5">param_grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb5-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'n_estimators'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>],</span>
<span id="cb5-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'max_features'</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sqrt'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'log2'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>],  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Removed 'auto' and added None</span></span>
<span id="cb5-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'max_depth'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>],</span>
<span id="cb5-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'min_samples_split'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>],</span>
<span id="cb5-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'min_samples_leaf'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span>
<span id="cb5-11">}</span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grid Search</span></span>
<span id="cb5-14">grid_search <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GridSearchCV(estimator<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rf_model, param_grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>param_grid, cv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, n_jobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, scoring<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'neg_mean_squared_error'</span>, verbose<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-15">grid_search.fit(X_train_prep, y_train)</span>
<span id="cb5-16"></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Best Model</span></span>
<span id="cb5-18">best_rf_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_search.best_estimator_</span>
<span id="cb5-19"></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Predictions and Evaluation</span></span>
<span id="cb5-21">y_pred_rf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> best_rf_model.predict(X_test_prep)</span>
<span id="cb5-22">mse_rf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred_rf)</span>
<span id="cb5-23">r2_rf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r2_score(y_test, y_pred_rf)</span>
<span id="cb5-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random Forest Test MSE:"</span>, mse_rf)</span>
<span id="cb5-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random Forest Test R2:"</span>, r2_rf)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 3 folds for each of 324 candidates, totalling 972 fits
Random Forest Test MSE: 3815896212.7555285
Random Forest Test R2: 0.865534268688408</code></pre>
</div>
</div>
</section>
<section id="advanced-regression-analysis" class="level2">
<h2 class="anchored" data-anchor-id="advanced-regression-analysis">Advanced Regression Analysis</h2>
<p><strong>1. Exploring Feature Interactions</strong></p>
<p>Feature interactions can reveal complex relationships that might not be captured by individual features alone.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adding interaction terms</span></span>
<span id="cb7-2">poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PolynomialFeatures(degree<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, interaction_only<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, include_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb7-3">X_train_poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> poly.fit_transform(X_train_prep)</span>
<span id="cb7-4">X_test_poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> poly.transform(X_test_prep)</span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Re-training Linear Regression with Interaction Terms</span></span>
<span id="cb7-7">linear_model_interact <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LinearRegression()</span>
<span id="cb7-8">linear_model_interact.fit(X_train_poly, y_train)</span>
<span id="cb7-9"></span>
<span id="cb7-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluating the model with interaction terms</span></span>
<span id="cb7-11">y_pred_interact <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> linear_model_interact.predict(X_test_poly)</span>
<span id="cb7-12">mse_interact <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred_interact)</span>
<span id="cb7-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MSE with Interaction Terms:"</span>, mse_interact)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MSE with Interaction Terms: 2983950454.9349637</code></pre>
</div>
</div>
<p><strong>2. Model Diagnostics for Linear Regression</strong></p>
<p>Checking assumptions and diagnostics of linear regression to ensure the validity of the model.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model Diagnostics</span></span>
<span id="cb9-2">X_train_sm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sm.add_constant(X_train_prep)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adding a constant</span></span>
<span id="cb9-3">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sm.OLS(y_train, X_train_sm).fit()</span>
<span id="cb9-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(model.summary())</span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Residuals plot</span></span>
<span id="cb9-7">plt.scatter(model.predict(X_train_sm), model.resid)</span>
<span id="cb9-8">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb9-9">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Residuals'</span>)</span>
<span id="cb9-10">plt.axhline(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>)</span>
<span id="cb9-11">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Residuals vs Predicted'</span>)</span>
<span id="cb9-12">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  Price   R-squared:                       0.917
Model:                            OLS   Adj. R-squared:                  0.914
Method:                 Least Squares   F-statistic:                     283.3
Date:                Sun, 10 Dec 2023   Prob (F-statistic):          3.91e-119
Time:                        03:45:05   Log-Likelihood:                -2932.4
No. Observations:                 240   AIC:                             5885.
Df Residuals:                     230   BIC:                             5920.
Df Model:                           9                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const       4.798e+05   2602.372    184.377      0.000    4.75e+05    4.85e+05
x1           1.56e+05   3262.250     47.819      0.000     1.5e+05    1.62e+05
x2          5.035e+04   3267.184     15.410      0.000    4.39e+04    5.68e+04
x3          2.194e+04   3304.761      6.640      0.000    1.54e+04    2.85e+04
x4         -1.011e+04   3260.647     -3.100      0.002   -1.65e+04   -3684.133
x5         -2624.2257   3281.530     -0.800      0.425   -9089.930    3841.478
x6           -41.7240   3263.210     -0.013      0.990   -6471.330    6387.882
x7          1.215e+05   5467.126     22.218      0.000    1.11e+05    1.32e+05
x8           1.26e+05   5609.374     22.456      0.000    1.15e+05    1.37e+05
x9          1.184e+05   6164.082     19.216      0.000    1.06e+05    1.31e+05
x10         1.139e+05   5567.918     20.463      0.000    1.03e+05    1.25e+05
==============================================================================
Omnibus:                        0.912   Durbin-Watson:                   2.215
Prob(Omnibus):                  0.634   Jarque-Bera (JB):                0.697
Skew:                          -0.123   Prob(JB):                        0.706
Kurtosis:                       3.097   Cond. No.                     6.20e+15
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The smallest eigenvalue is 7.83e-30. This might indicate that there are
strong multicollinearity problems or that the design matrix is singular.</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Linear and Non Linear Regression/index_files/figure-html/cell-7-output-2.png" width="629" height="449"></p>
</div>
</div>
<p><strong>3. Learning Curves</strong></p>
<p>Understanding how model performance changes as the training set size increases.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Learning curve function</span></span>
<span id="cb11-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plot_learning_curve(estimator, X, y, title):</span>
<span id="cb11-3">    train_sizes, train_scores, test_scores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learning_curve(estimator, X, y, cv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, n_jobs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, train_sizes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.linspace(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb11-4">    train_scores_mean <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(train_scores, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb11-5">    test_scores_mean <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(test_scores, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb11-6"></span>
<span id="cb11-7">    plt.figure()</span>
<span id="cb11-8">    plt.title(title)</span>
<span id="cb11-9">    plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Training examples"</span>)</span>
<span id="cb11-10">    plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Score"</span>)</span>
<span id="cb11-11">    plt.plot(train_sizes, train_scores_mean, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o-'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r"</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Training score"</span>)</span>
<span id="cb11-12">    plt.plot(train_sizes, test_scores_mean, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o-'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g"</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cross-validation score"</span>)</span>
<span id="cb11-13">    plt.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"best"</span>)</span>
<span id="cb11-14">    plt.grid()</span>
<span id="cb11-15">    plt.show()</span>
<span id="cb11-16"></span>
<span id="cb11-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting learning curve for Linear Regression</span></span>
<span id="cb11-18">plot_learning_curve(linear_model, X_train_prep, y_train, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear Regression Learning Curve"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Linear and Non Linear Regression/index_files/figure-html/cell-8-output-1.png" width="617" height="449"></p>
</div>
</div>
<p><strong>4. Ensemble Methods</strong></p>
<p>Combining multiple regression models to improve predictive performance.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient Boosting Regressor</span></span>
<span id="cb12-2">gb_reg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GradientBoostingRegressor(n_estimators<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, learning_rate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, max_depth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb12-3">gb_reg.fit(X_train_prep, y_train)</span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluation</span></span>
<span id="cb12-6">y_pred_gb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gb_reg.predict(X_test_prep)</span>
<span id="cb12-7">mse_gb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred_gb)</span>
<span id="cb12-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gradient Boosting Regressor MSE:"</span>, mse_gb)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Gradient Boosting Regressor MSE: 3673304675.984175</code></pre>
</div>
</div>
</section>
<section id="deeper-regression-analysis" class="level2">
<h2 class="anchored" data-anchor-id="deeper-regression-analysis">Deeper Regression Analysis</h2>
<p><strong>Feature Importance-Based Selection</strong></p>
<p>First, let’s use a model to identify the most important features and then retrain our models using only these features.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Feature Importance with Random Forest</span></span>
<span id="cb14-2">rf_for_importance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RandomForestRegressor()</span>
<span id="cb14-3">rf_for_importance.fit(X_train_prep, y_train)</span>
<span id="cb14-4"></span>
<span id="cb14-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get feature importances and corresponding feature names</span></span>
<span id="cb14-6">importances <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rf_for_importance.feature_importances_</span>
<span id="cb14-7">feature_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prep_pipeline.get_feature_names_out()</span>
<span id="cb14-8"></span>
<span id="cb14-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Creating a DataFrame for visualization</span></span>
<span id="cb14-10">importance_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Feature'</span>: feature_names, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Importance'</span>: importances}).sort_values(by<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Importance'</span>, ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb14-11"></span>
<span id="cb14-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjusting the threshold for feature selection</span></span>
<span id="cb14-13">top_features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> importance_df[importance_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Importance'</span>].cumsum() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.90</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Feature'</span>]</span>
<span id="cb14-14"></span>
<span id="cb14-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure that top_features is not empty</span></span>
<span id="cb14-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(top_features) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb14-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No features selected. Consider loosening the feature selection criterion."</span>)</span>
<span id="cb14-18"></span>
<span id="cb14-19">X_train_top <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X_train_prep[:, [feature_names.tolist().index(feat) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> feat <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> top_features]]</span>
<span id="cb14-20">X_test_top <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X_test_prep[:, [feature_names.tolist().index(feat) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> feat <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> top_features]]</span>
<span id="cb14-21"></span>
<span id="cb14-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Re-train models with top features</span></span>
<span id="cb14-23">linear_model_top <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LinearRegression()</span>
<span id="cb14-24">linear_model_top.fit(X_train_top, y_train)</span>
<span id="cb14-25"></span>
<span id="cb14-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluation</span></span>
<span id="cb14-27">y_pred_top <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> linear_model_top.predict(X_test_top)</span>
<span id="cb14-28">mse_top <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred_top)</span>
<span id="cb14-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Top Features Linear Regression MSE:"</span>, mse_top)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top Features Linear Regression MSE: 5967275811.385474</code></pre>
</div>
</div>
</section>
<section id="advanced-non-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="advanced-non-linear-models">Advanced Non-Linear Models</h2>
<p>Incorporating more complex non-linear models such as Support Vector Regression and Neural Networks.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Support Vector Regression</span></span>
<span id="cb16-2">svr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SVR(kernel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rbf'</span>, C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, gamma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'scale'</span>)</span>
<span id="cb16-3">svr.fit(X_train_prep, y_train)</span>
<span id="cb16-4"></span>
<span id="cb16-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluation</span></span>
<span id="cb16-6">y_pred_svr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> svr.predict(X_test_prep)</span>
<span id="cb16-7">mse_svr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred_svr)</span>
<span id="cb16-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Support Vector Regression MSE:"</span>, mse_svr)</span>
<span id="cb16-9"></span>
<span id="cb16-10">nn_reg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MLPRegressor(hidden_layer_sizes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>), </span>
<span id="cb16-11">                      max_iter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, </span>
<span id="cb16-12">                      learning_rate_init<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>, </span>
<span id="cb16-13">                      solver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adam'</span>, </span>
<span id="cb16-14">                      early_stopping<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, </span>
<span id="cb16-15">                      n_iter_no_change<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb16-16">                      random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb16-17">nn_reg.fit(X_train_prep, y_train)</span>
<span id="cb16-18"></span>
<span id="cb16-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluation</span></span>
<span id="cb16-20">y_pred_nn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn_reg.predict(X_test_prep)</span>
<span id="cb16-21">mse_nn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred_nn)</span>
<span id="cb16-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Neural Network Regression MSE:"</span>, mse_nn)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Support Vector Regression MSE: 28406556463.671677
Neural Network Regression MSE: 397201687873.44415</code></pre>
</div>
</div>
<p><strong>Building and Evaluating the Linear Regression Model</strong></p>
<p>A. Final Model Training</p>
<p>We’ll train the final models using the best parameters found from previous steps.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.linear_model <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LinearRegression</span>
<span id="cb18-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.neural_network <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MLPRegressor</span>
<span id="cb18-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.metrics <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> mean_squared_error, r2_score</span>
<span id="cb18-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb18-5"></span>
<span id="cb18-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Linear Regression</span></span>
<span id="cb18-7">linear_model_final <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LinearRegression()</span>
<span id="cb18-8">linear_model_final.fit(X_train_prep, y_train)</span>
<span id="cb18-9"></span>
<span id="cb18-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Neural Network</span></span>
<span id="cb18-11">nn_model_final <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MLPRegressor(hidden_layer_sizes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>), </span>
<span id="cb18-12">                              max_iter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, </span>
<span id="cb18-13">                              learning_rate_init<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>, </span>
<span id="cb18-14">                              solver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adam'</span>, </span>
<span id="cb18-15">                              early_stopping<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, </span>
<span id="cb18-16">                              n_iter_no_change<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb18-17">                              random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb18-18">nn_model_final.fit(X_train_prep, y_train)</span>
<span id="cb18-19"></span>
<span id="cb18-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Predictions</span></span>
<span id="cb18-21">y_pred_linear <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> linear_model_final.predict(X_test_prep)</span>
<span id="cb18-22">y_pred_nn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn_model_final.predict(X_test_prep)</span></code></pre></div>
</div>
<p>B. Evaluation Metrics</p>
<p>Calculating and printing evaluation metrics for both models. We’ll train the final models using the best parameters found from previous steps.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluation for Linear Regression</span></span>
<span id="cb19-2">mse_linear <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred_linear)</span>
<span id="cb19-3">r2_linear <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r2_score(y_test, y_pred_linear)</span>
<span id="cb19-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear Regression - MSE:"</span>, mse_linear, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R2:"</span>, r2_linear)</span>
<span id="cb19-5"></span>
<span id="cb19-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluation for Neural Network</span></span>
<span id="cb19-7">mse_nn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred_nn)</span>
<span id="cb19-8">r2_nn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r2_score(y_test, y_pred_nn)</span>
<span id="cb19-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Neural Network - MSE:"</span>, mse_nn, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R2:"</span>, r2_nn)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression - MSE: 2520672652.9396286 R2: 0.9111757572070075
Neural Network - MSE: 397201687873.44415 R2: -12.996715964015438</code></pre>
</div>
</div>
<p>C. Plotting Model Performance</p>
<p>Visualizing the performance of the models using scatter plots and residual plots.</p>
<p>I. Scatter Plot for Predictions.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb21-2"></span>
<span id="cb21-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scatter plot for Linear Regression</span></span>
<span id="cb21-4">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb21-5">plt.scatter(y_test, y_pred_linear, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb21-6">plt.plot([y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()], [y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>, lw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb21-7">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Actual'</span>)</span>
<span id="cb21-8">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb21-9">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linear Regression Predictions'</span>)</span>
<span id="cb21-10"></span>
<span id="cb21-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scatter plot for Neural Network</span></span>
<span id="cb21-12">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb21-13">plt.scatter(y_test, y_pred_nn, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb21-14">plt.plot([y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()], [y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>, lw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb21-15">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Actual'</span>)</span>
<span id="cb21-16">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb21-17">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neural Network Predictions'</span>)</span>
<span id="cb21-18"></span>
<span id="cb21-19">plt.tight_layout()</span>
<span id="cb21-20">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Linear and Non Linear Regression/index_files/figure-html/cell-14-output-1.png" width="1142" height="566"></p>
</div>
</div>
<ol start="2" type="I">
<li>Residual Plot</li>
</ol>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb22-2"></span>
<span id="cb22-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Residual plot for Linear Regression</span></span>
<span id="cb22-4">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb22-5">plt.scatter(y_pred_linear, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_pred_linear, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb22-6">plt.hlines(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_pred_linear.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_pred_linear.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(), colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, linestyles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dashed'</span>)</span>
<span id="cb22-7">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb22-8">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Residuals'</span>)</span>
<span id="cb22-9">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linear Regression Residuals'</span>)</span>
<span id="cb22-10"></span>
<span id="cb22-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Residual plot for Neural Network</span></span>
<span id="cb22-12">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb22-13">plt.scatter(y_pred_nn, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_pred_nn, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb22-14">plt.hlines(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_pred_nn.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_pred_nn.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(), colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, linestyles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dashed'</span>)</span>
<span id="cb22-15">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb22-16">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Residuals'</span>)</span>
<span id="cb22-17">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neural Network Residuals'</span>)</span>
<span id="cb22-18"></span>
<span id="cb22-19">plt.tight_layout()</span>
<span id="cb22-20">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Linear and Non Linear Regression/index_files/figure-html/cell-15-output-1.png" width="1142" height="566"></p>
</div>
</div>
<p><strong>Building and Evaluating Non-Linear Model (Support Vector Regression)</strong></p>
<p>A. Training the Support Vector Regressor</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.svm <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SVR</span>
<span id="cb23-2"></span>
<span id="cb23-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Support Vector Regression</span></span>
<span id="cb23-4">svr_model_final <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SVR(kernel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rbf'</span>, C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, gamma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'scale'</span>)</span>
<span id="cb23-5">svr_model_final.fit(X_train_prep, y_train)</span>
<span id="cb23-6"></span>
<span id="cb23-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Predictions</span></span>
<span id="cb23-8">y_pred_svr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> svr_model_final.predict(X_test_prep)</span></code></pre></div>
</div>
<p>B. Evaluation Metrics for SVR</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evaluation for Support Vector Regression</span></span>
<span id="cb24-2">mse_svr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred_svr)</span>
<span id="cb24-3">r2_svr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r2_score(y_test, y_pred_svr)</span>
<span id="cb24-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Support Vector Regression - MSE:"</span>, mse_svr, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R2:"</span>, r2_svr)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Support Vector Regression - MSE: 28406556463.671677 R2: -0.0009990251211158263</code></pre>
</div>
</div>
<p>C. Plotting Comparisons</p>
<p>Visualizing the performance of the Linear Regression, Neural Network, and Support Vector Regression models.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb26-2"></span>
<span id="cb26-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Linear Regression</span></span>
<span id="cb26-4">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb26-5">plt.scatter(y_test, y_pred_linear, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb26-6">plt.plot([y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()], [y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>, lw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb26-7">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Actual'</span>)</span>
<span id="cb26-8">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb26-9">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linear Regression Predictions'</span>)</span>
<span id="cb26-10"></span>
<span id="cb26-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Neural Network</span></span>
<span id="cb26-12">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb26-13">plt.scatter(y_test, y_pred_nn, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb26-14">plt.plot([y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()], [y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>, lw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb26-15">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Actual'</span>)</span>
<span id="cb26-16">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb26-17">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neural Network Predictions'</span>)</span>
<span id="cb26-18"></span>
<span id="cb26-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Support Vector Regression</span></span>
<span id="cb26-20">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb26-21">plt.scatter(y_test, y_pred_svr, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'green'</span>)</span>
<span id="cb26-22">plt.plot([y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()], [y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), y_test.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>, lw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb26-23">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Actual'</span>)</span>
<span id="cb26-24">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb26-25">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Support Vector Regression Predictions'</span>)</span>
<span id="cb26-26"></span>
<span id="cb26-27">plt.tight_layout()</span>
<span id="cb26-28">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Linear and Non Linear Regression/index_files/figure-html/cell-18-output-1.png" width="1718" height="566"></p>
</div>
</div>
<p>D. Residual Plot for All Models</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb27-2"></span>
<span id="cb27-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Linear Regression Residuals</span></span>
<span id="cb27-4">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb27-5">plt.scatter(y_pred_linear, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_pred_linear, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb27-6">plt.hlines(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_pred_linear.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_pred_linear.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(), colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, linestyles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dashed'</span>)</span>
<span id="cb27-7">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb27-8">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Residuals'</span>)</span>
<span id="cb27-9">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Linear Regression Residuals'</span>)</span>
<span id="cb27-10"></span>
<span id="cb27-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Neural Network Residuals</span></span>
<span id="cb27-12">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb27-13">plt.scatter(y_pred_nn, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_pred_nn, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb27-14">plt.hlines(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_pred_nn.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_pred_nn.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(), colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, linestyles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dashed'</span>)</span>
<span id="cb27-15">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb27-16">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Residuals'</span>)</span>
<span id="cb27-17">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Neural Network Residuals'</span>)</span>
<span id="cb27-18"></span>
<span id="cb27-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SVR Residuals</span></span>
<span id="cb27-20">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb27-21">plt.scatter(y_pred_svr, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_pred_svr, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'green'</span>)</span>
<span id="cb27-22">plt.hlines(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_pred_svr.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(), xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y_pred_svr.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(), colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, linestyles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dashed'</span>)</span>
<span id="cb27-23">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb27-24">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Residuals'</span>)</span>
<span id="cb27-25">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Support Vector Regression Residuals'</span>)</span>
<span id="cb27-26"></span>
<span id="cb27-27">plt.tight_layout()</span>
<span id="cb27-28">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Linear and Non Linear Regression/index_files/figure-html/cell-19-output-1.png" width="1718" height="566"></p>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In conclusion, the fields of random processes and probability theory, as well as linear and nonlinear regression, are vital components of machine learning when applied to diverse datasets such as weather and housing data. These foundational concepts empower us to model and make predictions in the face of inherent uncertainty, allowing for more accurate forecasts, informed decision-making, and improved insights.</p>
<p>For weather data analysis, random processes and probability theory enable us to understand and quantify the stochastic nature of weather patterns. Leveraging machine learning techniques on this data helps us provide accurate forecasts and anticipate extreme events, benefiting numerous sectors that rely on weather information.</p>
<p>In the case of housing data analysis, linear and nonlinear regression techniques enable us to model complex relationships between housing features and prices. Whether it’s linear relationships for straightforward cases or nonlinear models to capture intricate patterns, these tools empower us to make more informed decisions in real estate, investments, and market analysis.</p>
<p>In both domains, machine learning applied to these fundamental concepts provides us with the means to extract valuable insights and make data-driven decisions, ultimately enhancing our understanding and predictive capabilities, and offering practical solutions that can improve the quality of life and the efficiency of various industries.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>machine learning</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/Linear and Non Linear Regression/index.html</guid>
  <pubDate>Fri, 24 Nov 2023 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/Linear and Non Linear Regression/image2.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Large Language Models (LLM)</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/llm/llm.html</link>
  <description><![CDATA[ 



<p><a href="https://en.wikipedia.org/wiki/Large_language_model#:~:text=A%20large%20language%20model%20(LLM)%20is%20a%20type%20of%20language%20model%20notable%20for%20its%20ability%20to%20achieve%20general%2Dpurpose%20language%20understanding%20and%20generation.">Large Language Models</a> (LLMs) are a way to automatically generate text. more informative commit messages based on the currently staged changes.</p>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>Tools</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/llm/llm.html</guid>
  <pubDate>Fri, 24 Nov 2023 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/llm/dalle_llm-guru.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Probability Theory and Random Processes</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/Random Processes/index.html</link>
  <description><![CDATA[ 



<section id="gaining-insights-on-weather-data-with-data-science-and-machine-learning" class="level2">
<h2 class="anchored" data-anchor-id="gaining-insights-on-weather-data-with-data-science-and-machine-learning">Gaining insights on weather data with Data Science and Machine Learning</h2>
<p>In this blog post I will discuss a few examples of <a href="https://en.wikipedia.org/wiki/Probability#:~:text=Probability%20is%20the%20branch%20of,event%20and%201%20indicates%20certainty.">probability</a> in <a href="https://en.wikipedia.org/wiki/Machine_learning#:~:text=Machine%20learning%20(ML)%20is%20a%20field%20of%20study%20in%20artificial%20intelligence%20concerned%20with%20the%20development%20and%20study%20of%20statistical%20algorithms%20that%20can%20effectively%20generalize%20and%20thus%20perform%20tasks%20without%20explicit%20instructions.">machine learning</a>. If you are new to probability, I recommend one of great textbooks that cover the topic and are available for free online, such as <a href="https://allendowney.github.io/ThinkBayes2">Think Bayes</a> by <a href="https://www.allendowney.com">Allen Downey</a> and <a href="https://www.bayesrulesbook.com">Bayes Rules!</a> by <a href="https://ajohns24.github.io">Alicia A. Johnson</a>, Miles Q. Ott, and <a href="https://www.minedogucu.com">Mine Dogucu</a>.</p>
<p><a href="https://en.wikipedia.org/wiki/Statistical_classification">Classification</a> <a href="https://en.wikipedia.org/wiki/Algorithm">algorithms</a> algorithms can estimate <img src="https://latex.codecogs.com/png.latex?n%20%5Ctimes%20k"> class membership probabilities for each dataset, where n is the number of data points in the dataset and k is the number of classes in the <a href="https://en.wikipedia.org/wiki/Training,_validation,_and_test_data_sets#:~:text=training%20data%20set%2C%5B3%5D%20which%20is%20a%20set%20of%20examples%20used%20to%20fit%20the%20parameters%20(e.g.%20weights%20of%20connections%20between%20neurons%20in%20artificial%20neural%20networks)%20of%20the%20model.">training dataset</a>. Similarly, the <a href="https://scikit-learn.org/stable/modules/mixture.html">Gaussian Mixtures</a> <a href="https://scikit-learn.org/stable/modules/clustering.html">clustering</a> algorithm can generate <img src="https://latex.codecogs.com/png.latex?n%20%5Ctimes%20k"> cluster label probabilities.</p>
<p>Besides a data point and the Gaussian Mixtures models can estimate cluster membership probability. point , especially <a href="https://en.wikipedia.org/wiki/Logistic_regression">Logistic Regression</a> and <a href="https://en.wikipedia.org/wiki/Naive_Bayes_classifier">Naive Bayes</a>. Every classification algorithm can estimate probabilities of belonging to each class.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5CHuge%20P(A%5Cvert%20B)=%7B%5Cfrac%20%7BP(B%5Cvert%20A)P(A)%7D%7BP(B)%7D%7D"></p>
</section>
<section id="understanding-weather-forecasting-with-the-help-of-probability-theory-and-random-processes" class="level2">
<h2 class="anchored" data-anchor-id="understanding-weather-forecasting-with-the-help-of-probability-theory-and-random-processes">Understanding Weather Forecasting with the help of Probability theory and Random Processes</h2>
<p><strong>Introduction</strong></p>
<p>Machine learning plays a pivotal role in understanding and predicting various natural phenomena, and weather forecasting is no exception. To harness the power of machine learning for weather data analysis, it is essential to have a solid foundation in random processes and probability theory. These fundamental concepts are the building blocks that enable us to model the inherent uncertainty and variability present in weather data.</p>
<p>Weather data, such as temperature, humidity, wind speed, and precipitation, exhibit random behavior due to the complex interplay of atmospheric processes. Random processes are mathematical models used to describe the evolution of these variables over time. These processes capture the idea that weather conditions are not deterministic but rather stochastic, influenced by a multitude of factors, including geographical location, time of year, and local phenomena.</p>
<p>Probability theory, on the other hand, provides the framework to quantify and reason about uncertainty in weather data. It allows us to assign probabilities to different weather outcomes and make informed predictions based on observed data. For example, we can calculate the probability of rain on a given day or estimate the likelihood of extreme weather events, such as hurricanes or heatwaves, occurring in a specific region.</p>
<p>Machine learning techniques, such as regression, classification, and time series analysis, heavily rely on probabilistic and random process models to extract meaningful insights from weather data. By incorporating these techniques, we can build predictive models that not only provide accurate weather forecasts but also account for uncertainty, enabling better decision-making in various applications like agriculture, transportation, and disaster management.</p>
<p>In this context, the weather dataset you are using serves as a valuable source of information for exploring and applying these concepts. By understanding random processes and probability theory, you can leverage machine learning to unlock the potential hidden within weather data, improving the accuracy and reliability of weather forecasts and facilitating data-driven decision-making in various sectors that rely on weather information.</p>
<p><strong>Data Loading and Basic Visualization</strong></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importing libraries</span></span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> stats</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> norm</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> expon</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> train_test_split</span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.linear_model <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LinearRegression</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.metrics <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> mean_squared_error</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the dataset</span></span>
<span id="cb1-14">weather_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'weather_data.csv'</span>)</span>
<span id="cb1-15">weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Date'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.to_datetime(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Date'</span>])</span></code></pre></div>
</div>
<p><strong>Exploratory Data Analysis</strong></p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Exploratory Data Analysis</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Histograms and KDE (Kernel Density Estimation) plots for Temperature and Humidity.</span></span>
<span id="cb2-3">sns.histplot(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>], kde<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>)</span>
<span id="cb2-4">sns.histplot(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Humidity'</span>], kde<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'green'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Humidity'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb2-5">plt.legend()</span>
<span id="cb2-6">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Random Processes/index_files/figure-html/cell-3-output-1.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pair Plot to visualize all variables together.</span></span>
<span id="cb3-2">sns.pairplot(weather_df, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Weather_Condition'</span>)</span>
<span id="cb3-3">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Random Processes/index_files/figure-html/cell-4-output-1.png" width="618" height="476"></p>
</div>
</div>
<p><strong>Probability Distributions</strong></p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Normal Distribution Fit for Temperature.</span></span>
<span id="cb4-2">sns.histplot(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>], kde<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fitting a normal distribution and plotting it</span></span>
<span id="cb4-5">mean, std <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> norm.fit(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>])</span>
<span id="cb4-6">xmin, xmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.xlim()</span>
<span id="cb4-7">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(xmin, xmax, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb4-8">p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> norm.pdf(x, mean, std)</span>
<span id="cb4-9">plt.plot(x, p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>].value_counts()), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k'</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-10"></span>
<span id="cb4-11">title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fit results: mean = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%.2f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,  std = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%.2f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> (mean, std)</span>
<span id="cb4-12">plt.title(title)</span>
<span id="cb4-13"></span>
<span id="cb4-14">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Random Processes/index_files/figure-html/cell-5-output-1.png" width="593" height="449"></p>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Exponential Distribution Fit for Humidity.</span></span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> expon</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting histogram</span></span>
<span id="cb5-5">sns.histplot(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Humidity'</span>], kde<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'green'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Humidity'</span>)</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fitting an exponential distribution and plotting it</span></span>
<span id="cb5-8">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> expon.fit(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Humidity'</span>])</span>
<span id="cb5-9">xmin, xmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.xlim()</span>
<span id="cb5-10">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(xmin, xmax, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb5-11">p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> expon.pdf(x, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>params)</span>
<span id="cb5-12">plt.plot(x, p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Humidity'</span>].value_counts()), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k'</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-13"></span>
<span id="cb5-14">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Random Processes/index_files/figure-html/cell-6-output-1.png" width="593" height="429"></p>
</div>
</div>
<p><strong>Time Series Analysis</strong></p>
<p>Temperature Trend over Time.</p>
<p>#Checking the temperature trned against time weather_df.set_index(‘Date’)[‘Temperature’].plot() plt.title(“Temperature Trend Over Time”) plt.ylabel(“Temperature”) plt.show()</p>
<pre><code>


**Probability Theory in Action**

::: {.cell execution_count=7}
``` {.python .cell-code}
#Conditional Probability: Probability of High Humidity given Rainy Weather.
high_humidity = weather_df['Humidity'] &gt; 80
rainy_days = weather_df['Weather_Condition'] == 'Rainy'
prob_high_humidity_given_rain = np.mean(high_humidity[rainy_days])
print(f"Probability of High Humidity given Rainy Weather: {prob_high_humidity_given_rain}")</code></pre>
<div class="cell-output cell-output-stdout">
<pre><code>Probability of High Humidity given Rainy Weather: 0.27586206896551724</code></pre>
</div>
<p>:::</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Joint Distribution: Temperature and Humidity.</span></span>
<span id="cb8-2">sns.jointplot(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>weather_df, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Humidity'</span>, kind<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'kde'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb8-3">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Random Processes/index_files/figure-html/cell-8-output-1.png" width="570" height="566"></p>
</div>
</div>
<p><strong>Correlation Analysis</strong></p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Correlation Heatmap</span></span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Selecting only numerical columns for correlation analysis</span></span>
<span id="cb9-3">numerical_weather_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weather_df.select_dtypes(include<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[np.number])</span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting the correlation heatmap</span></span>
<span id="cb9-6">sns.heatmap(numerical_weather_df.corr(), annot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'coolwarm'</span>)</span>
<span id="cb9-7">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Correlation Heatmap"</span>)</span>
<span id="cb9-8">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Random Processes/index_files/figure-html/cell-9-output-1.png" width="533" height="431"></p>
</div>
</div>
<p><strong>Linear Regression for Temperature Prediction</strong></p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Model Training and Evaluation.</span></span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Preparing data for linear regression</span></span>
<span id="cb10-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.linear_model <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LinearRegression</span>
<span id="cb10-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.metrics <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> mean_squared_error</span>
<span id="cb10-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> train_test_split</span>
<span id="cb10-6"></span>
<span id="cb10-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Preparing data for linear regression</span></span>
<span id="cb10-8">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weather_df[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Humidity'</span>]]</span>
<span id="cb10-9">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>]</span>
<span id="cb10-10">X_train, X_test, y_train, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_test_split(X, y, test_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb10-11"></span>
<span id="cb10-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Training the model</span></span>
<span id="cb10-13">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LinearRegression()</span>
<span id="cb10-14">model.fit(X_train, y_train)</span>
<span id="cb10-15"></span>
<span id="cb10-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Making predictions</span></span>
<span id="cb10-17">y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.predict(X_test)</span>
<span id="cb10-18"></span>
<span id="cb10-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting actual vs predicted values</span></span>
<span id="cb10-20">plt.scatter(X_test, y_test, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Actual'</span>)</span>
<span id="cb10-21">plt.scatter(X_test, y_pred, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted'</span>)</span>
<span id="cb10-22">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Humidity'</span>)</span>
<span id="cb10-23">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>)</span>
<span id="cb10-24">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Actual vs Predicted Temperature'</span>)</span>
<span id="cb10-25">plt.legend()</span>
<span id="cb10-26">plt.show()</span>
<span id="cb10-27"></span>
<span id="cb10-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model evaluation</span></span>
<span id="cb10-29">mse <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb10-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean Squared Error:"</span>, mse)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/Random Processes/index_files/figure-html/cell-10-output-1.png" width="585" height="449"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Squared Error: 24.010797366937965</code></pre>
</div>
</div>
<p><strong>Markov Chain for Weather Condition Transitions</strong></p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Let's simulate a simple Markov chain to model the transitions between different weather conditions.</span></span>
<span id="cb12-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb12-3"></span>
<span id="cb12-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculating transition probabilities</span></span>
<span id="cb12-5">weather_conditions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Weather_Condition'</span>].unique()</span>
<span id="cb12-6">transition_matrix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>weather_conditions, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>weather_conditions).fillna(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb12-7"></span>
<span id="cb12-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (prev, curr) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Weather_Condition'</span>], weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Weather_Condition'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]):</span>
<span id="cb12-9">    transition_matrix.at[prev, curr] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb12-10"></span>
<span id="cb12-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Normalizing the rows to sum to 1</span></span>
<span id="cb12-12">transition_matrix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> transition_matrix.div(transition_matrix.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb12-13"></span>
<span id="cb12-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the transition matrix</span></span>
<span id="cb12-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(transition_matrix)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Windy     Snowy    Cloudy     Foggy     Sunny     Rainy
Windy   0.155116  0.165017  0.161716  0.194719  0.181518  0.141914
Snowy   0.196667  0.166667  0.153333  0.166667  0.156667  0.160000
Cloudy  0.144543  0.182891  0.171091  0.165192  0.188791  0.147493
Foggy   0.199346  0.124183  0.199346  0.147059  0.140523  0.189542
Sunny   0.167247  0.167247  0.222997  0.167247  0.128920  0.146341
Rainy   0.131488  0.179931  0.211073  0.166090  0.141869  0.169550</code></pre>
</div>
</div>
<p>This code calculates the probabilities of transitioning from one weather condition to another. It’s a basic form of a Markov chain.</p>
<p><strong>Monte Carlo Simulation for Temperature Extremes</strong></p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Use Monte Carlo simulation to estimate the probability of extreme temperature events.</span></span>
<span id="cb14-2">np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb14-3">num_simulations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span></span>
<span id="cb14-4">extreme_temp_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb14-5">extreme_temp_threshold <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define what you consider as extreme temperature</span></span>
<span id="cb14-6"></span>
<span id="cb14-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_simulations):</span>
<span id="cb14-8">    simulated_temp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.choice(weather_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>])</span>
<span id="cb14-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> simulated_temp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> extreme_temp_threshold:</span>
<span id="cb14-10">        extreme_temp_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb14-11"></span>
<span id="cb14-12">probability_of_extreme_temp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> extreme_temp_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> num_simulations</span>
<span id="cb14-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Probability of Extreme Temperature (&gt; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>extreme_temp_threshold<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°C): </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>probability_of_extreme_temp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Probability of Extreme Temperature (&gt; 30°C): 0.0226</code></pre>
</div>
</div>
<p>This Monte Carlo simulation randomly samples temperatures from the dataset and calculates the probability of encountering temperatures above a certain threshold.</p>
</section>
<section id="obtain-the-logistic-function-mathematically" class="level1">
<h1>Obtain the logistic function mathematically</h1>
<section id="step-1.-write-out-the-linear-regression-equation" class="level2">
<h2 class="anchored" data-anchor-id="step-1.-write-out-the-linear-regression-equation">Step 1. Write out the linear regression equation</h2>
<p><img src="https://latex.codecogs.com/png.latex?%5CHuge%20y=%5Cbeta_0+%5Cbeta_1%20x_1+...+%5Cbeta_n%20x_n"></p>
</section>
<section id="step-2.-the-logistic-regression-equation-is-the-same-as-above-except-output-is-log-odds" class="level2">
<h2 class="anchored" data-anchor-id="step-2.-the-logistic-regression-equation-is-the-same-as-above-except-output-is-log-odds">Step 2. The logistic regression equation is the same as above except output is log odds</h2>
<p><img src="https://latex.codecogs.com/png.latex?%5CHuge%20log(odds)=%5Cbeta_0+%5Cbeta_1%20x_1+...+%5Cbeta_n%20x_n"></p>
</section>
<section id="step-3.-exponentiate-both-sides-of-the-logistic-regression-equation-to-get-odds" class="level2">
<h2 class="anchored" data-anchor-id="step-3.-exponentiate-both-sides-of-the-logistic-regression-equation-to-get-odds">Step 3. Exponentiate both sides of the logistic regression equation to get odds</h2>
<p><img src="https://latex.codecogs.com/png.latex?%5CHuge%20odds=e%5E%7B%5Cbeta_0+%5Cbeta_1%20x_1+...+%5Cbeta_n%20x_n%7D"></p>
</section>
<section id="step-4.-write-out-the-probability-equation" class="level2">
<h2 class="anchored" data-anchor-id="step-4.-write-out-the-probability-equation">Step 4. Write out the probability equation</h2>
<p><img src="https://latex.codecogs.com/png.latex?%5CHuge%20p=%5Cfrac%7Bodds%7D%7B1+odds%7D"></p>
</section>
<section id="step-5.-plug-odds-from-step-3-into-the-probability-equation" class="level2">
<h2 class="anchored" data-anchor-id="step-5.-plug-odds-from-step-3-into-the-probability-equation">Step 5. Plug odds (from step 3) into the probability equation</h2>
<p><img src="https://latex.codecogs.com/png.latex?%5CHuge%20p=%5Cfrac%7Be%5E%7B%5Cbeta_0+%5Cbeta_1%20x_1+...+%5Cbeta_n%20x_n%7D%7D%7B1+e%5E%7B%5Cbeta_0+%5Cbeta_1%20x_1+...+%5Cbeta_n%20x_n%7D%7D"></p>
</section>
<section id="step-6.-divide-the-numerator-and-denominator-by-the-odds-from-step-3" class="level2">
<h2 class="anchored" data-anchor-id="step-6.-divide-the-numerator-and-denominator-by-the-odds-from-step-3">Step 6. Divide the numerator and denominator by the odds (from step 3)</h2>
<p><img src="https://latex.codecogs.com/png.latex?%5CHuge%20p=%5Cfrac%7B1%7D%7B1+e%5E%7B-(%5Cbeta_0+%5Cbeta_1%20x_1+...+%5Cbeta_n%20x_n)%7D%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5CHuge%20P(A%5Cvert%20B)=%7B%5Cfrac%20%7BP(B%5Cvert%20A)P(A)%7D%7BP(B)%7D%7D"></p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>This analysis shows more sophisticated ways of applying probability theory and random processes to the weather dataset, providing insights into weather patterns and temperature predictions.</p>
<p>Summarized the findings from the above analysis. Discussed the relevance of these probabilistic models in understanding weather patterns.</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>machine learning</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/Random Processes/index.html</guid>
  <pubDate>Fri, 24 Nov 2023 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/Random Processes/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Data Science Hangout</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/2023-01-01-data-science-hangout/2023-01-01-data-science-hangout.html</link>
  <description><![CDATA[ 



<section id="background" class="level1">
<h1>Background</h1>
<p>I’ve been attending Posit’s weekly <a href="https://posit.co/data-science-hangout/">Data Science Hangout</a> since 2021 and it’s been one of my favorite standing weekly meetings. This is a great platform to hear how data science leaders are using R to drive business results and the host, Rachael Dempsey, does an excellent job fostering an inclusive and open culture. I was thrilled to be the guest several weeks ago in Dec 2022. 🚀</p>
<p>I talked about my transition to data science from a career in financial modeling and consulting, talked about my love for Shiny and the R community, and gave some tips on how to start your own data science community. I also said “you know” an inordinate number of times, please forgive me in advance. 🙃</p>
<p>Whether you’re a data science practitioner, student, looking to make a career pivot, or simply wanting to network, the Data Science Hangout has something for all. If you haven’t already, I highly encourage you to attend Posit’s Data Science Hangout live sometime in the future.</p>
</section>
<section id="watch-on-youtube" class="level1">
<h1>Watch on YouTube</h1>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/-mm5tHQVPY8" title="From Excel to Lead Machine Learning Engineer" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>tidyverse</category>
  <category>machine learning</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/2023-01-01-data-science-hangout/2023-01-01-data-science-hangout.html</guid>
  <pubDate>Sun, 01 Jan 2023 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/2023-01-01-data-science-hangout/images/Posit_Data_Science_Hangout.png" medium="image" type="image/png" height="78" width="144"/>
</item>
<item>
  <title>A Brief History of the Dataframe</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/2021-05-24-dataframe/2021-05-24-dataframe.html</link>
  <description><![CDATA[ 



<p>This is quite the insightful read on the history of the dataframe. From its origins in the S programming language, to R, to the <code>pandas</code> library for Python (to the <code>tibble</code> for R!)… I couldn’t imagine doing my work without this fundamental data structure, but will it really be defined out of existence? See below link for an excellent overview by <a href="https://devin-petersohn.medium.com/">Devin Petersohn</a>:</p>
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2021-05-24-dataframe/images/dataframe.jpeg" class="img-fluid"></p>
<p>Source:</p>
<ul>
<li><p><a href="https://towardsdatascience.com/preventing-the-death-of-the-dataframe-8bca1c0f83c8">Towards Data Science: Preventing the Death of the Dataframe</a></p></li>
<li><p><a href="https://pandas.pydata.org/">pandas for Python</a></p></li>
<li><p><a href="https://tibble.tidyverse.org/">tibble for R</a></p></li>
</ul>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>tibble</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/2021-05-24-dataframe/2021-05-24-dataframe.html</guid>
  <pubDate>Mon, 24 May 2021 04:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/2021-05-24-dataframe/images/dataframe.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>DT: An R Interface to the JavaScript library DataTables</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/2021-05-03-DT/2021-05-03-DT.html</link>
  <description><![CDATA[ 



<p>The <a href="https://rstudio.github.io/DT/">DT package</a> for R is a powerful integration of the JavaScript library <em>DataTables</em>. One of the things that I enjoy with <code>DT</code> is enhancing my Shiny apps by rendering interactive tables with <code>DT</code>. The <code>DT</code> documentation, written by <a href="https://www.rstudio.com/">RStudio PBC</a> and the <code>DT</code> devs, is incredibly well-written and you’ll learn a lot about how you can use these tables in the development of robust R web apps. And the available Options…. Endless in a good way!</p>
<p>If you’re a Shiny dev, check out the live demos sourced below.</p>
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2021-05-03-DT/images/DT_Shiny.png" class="img-fluid"></p>
<p>Source:</p>
<ul>
<li><p><a href="https://github.com/rstudio/DT">DT on GitHub</a></p></li>
<li><p><a href="https://rstudio.github.io/DT/">DT site</a></p></li>
<li><p><a href="https://yihui.shinyapps.io/DT-selection/">Live Shiny demo: DT Selections Ex. 1</a></p></li>
<li><p><a href="https://yihui.shinyapps.io/DT-rows/">Live Shiny demo: DT Selection Ex. 2</a></p></li>
</ul>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>dt</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/2021-05-03-DT/2021-05-03-DT.html</guid>
  <pubDate>Mon, 03 May 2021 04:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/2021-05-03-DT/images/DT_Shiny.png" medium="image" type="image/png" height="84" width="144"/>
</item>
<item>
  <title>Preparing for 2021 Goals with a Raspberry Pi</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/2020-12-31-Raspberry-Pi/2020-12-31-Raspberry-Pi.html</link>
  <description><![CDATA[ 



<p>Killing a few birds with one stone and getting ready for 2021… <br><br>1) Getting better at Linux / shell commands, <br> 2) Learning Julia (see my Resources tab for some great Julia starter links!), <br> 3) Doing it all on a Raspberry Pi 😜 Happy holidays and Happy New Years to all!</p>
<p>Below are some pics of my current progress.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2020-12-31-Raspberry-Pi/images/Pi1.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Raspberry Pi 4, Model B, 8GB RAM, &amp; Super Cute Tiny Heat Sinks</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2020-12-31-Raspberry-Pi/images/Pi2.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Enclosing the Pi 4 in a CanaKit case + fan</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2020-12-31-Raspberry-Pi/images/Pi3.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Raspberry Pi OS, a Debian distro for the Pi</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2020-12-31-Raspberry-Pi/images/Pi4.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Jupyter Lab server on the Pi set up w/ Python, R, and Julia</figcaption>
</figure>
</div>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>linux</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/2020-12-31-Raspberry-Pi/2020-12-31-Raspberry-Pi.html</guid>
  <pubDate>Thu, 31 Dec 2020 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/2020-12-31-Raspberry-Pi/images/Pi-banner.png" medium="image" type="image/png" height="76" width="144"/>
</item>
<item>
  <title>Detailed R Package Development Tutorial from Method Bites</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/2020-09-13-R-Package-Detailed-Tutorial/2020-09-13-R-Package-Detailed-Tutorial.html</link>
  <description><![CDATA[ 



<p>I’ll keep this short since all credit should go towards the amazing Cosima Meyer and Dennis Hammerschmidton… They compressed some of the most valuable steps for creating and deploying a package. This duo’s work was published for the MZES Social Science Data Lab. If you want a detailed and easy-to-follow how-to for R package development, bookmark this step-by-step guide!</p>
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2020-09-13-R-Package-Detailed-Tutorial/images/package_dev.png" class="img-fluid"></p>
<p>Source:<br> * Methods Bites: <a href="https://www.mzes.uni-mannheim.de/socialsciencedatalab/article/r-package/">How to write your own R package and publish it on CRAN</a></p>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>packages</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/2020-09-13-R-Package-Detailed-Tutorial/2020-09-13-R-Package-Detailed-Tutorial.html</guid>
  <pubDate>Sun, 13 Sep 2020 04:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/2020-09-13-R-Package-Detailed-Tutorial/images/methods_bites.png" medium="image" type="image/png" height="167" width="144"/>
</item>
<item>
  <title>D&amp;D Adventures + blogdown</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/2020-04-05-DnD-Adventures/2020-04-05-DnD-Adventures.html</link>
  <description><![CDATA[ 



<p>Wizards of the Coast have developed such an incredible tabletop, fantasy, RPG with the 5th edition of D&amp;D… I wish I would have re-discovered this game years back. For context, I haven’t touched D&amp;D since 1997!</p>
<p>If you know of good resources for newbies and new D&amp;D Dungeon Masters (“DMs”), I’d love to know about your favorite resources. For data science folks out there, this site was built with R using <code>blogdown</code>, Hugo themes, and deployed for free using GitHub and Netlify.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2020-04-05-DnD-Adventures/images/Dnd.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">D&amp;D dragon looking for trouble</figcaption>
</figure>
</div>
<p>Reference: <br> * Javier’s <a href="https://flamboyant-brahmagupta-3caca6.netlify.app/">D&amp;D Adventures</a></p>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>rmarkdown</category>
  <category>blogdown</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/2020-04-05-DnD-Adventures/2020-04-05-DnD-Adventures.html</guid>
  <pubDate>Sun, 05 Apr 2020 04:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/2020-04-05-DnD-Adventures/images/Dnd.png" medium="image" type="image/png" height="61" width="144"/>
</item>
<item>
  <title>Resampling with k-fold Cross Validation</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/2020-02-01-k-fold-cross-validation/2020-02-01-k-fold-cross-validation.html</link>
  <description><![CDATA[ 



<p>k-fold “randomly divides the training data into k groups (or folds) of approximate size [with the model being] fit on k-1 folds and the remaining fold used to compute model performance.” I use k=5 or k=10 given that this is typical industry practice without really questioning “why?”</p>
<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2020-02-01-k-fold-cross-validation/images/kfold.jpg" class="img-fluid"></p>
<p>In reading through Hands-On Machine Learning with R by Brad Boehmke, Ph.D.&nbsp;and Brandon Greenwell, I was surprised to learn that studies have shown that k=10 performs similarly to leave-one-out cross validation where k=n.</p>
<p>Without realizing it, sometimes I get carried away optimizing code and drifting from statistics and the core “science” in data science… k-fold CV is a technique used by many and is agnostic to your statistical programming language of choice but if you’re an #R user, I can’t recommend this book enough (free in full online, link below)!</p>
<p>Source:</p>
<ul>
<li>Hands-On Machine Learning with R <a href="https://bradleyboehmke.github.io/HOML/process.html#resampling">Chapter 2.4 Resampling Methods</a></li>
</ul>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>statistics</category>
  <category>machine learning</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/2020-02-01-k-fold-cross-validation/2020-02-01-k-fold-cross-validation.html</guid>
  <pubDate>Sat, 01 Feb 2020 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/2020-02-01-k-fold-cross-validation/images/kfold.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Ubuntu Update to 19.10</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/2019-12-31-Ubuntu-Update/2019-12-31-Ubuntu-Update.html</link>
  <description><![CDATA[ 



<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2019-12-31-Ubuntu-Update/images/Ubuntu.jpg" class="img-fluid"></p>
<p>Update Ubuntu 19.04 to 19.10 on dual-booted systems. Not sure exactly where things broke down for me, but as of right now, #Ubuntu seems inaccessible. Not too bummed about it as everything is backed up, but if you’ve recently had the same heartburn and found a solution, please send me a message!</p>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>linux</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/2019-12-31-Ubuntu-Update/2019-12-31-Ubuntu-Update.html</guid>
  <pubDate>Tue, 31 Dec 2019 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/2019-12-31-Ubuntu-Update/images/Ubuntu.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Book Rec: Hands-On Machine Learning with R</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/2019-12-17-Hands-On-Machine-Learning-with-R/2019-12-17-Hands-On-Machine-Learning-with-R.html</link>
  <description><![CDATA[ 



<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2019-12-17-Hands-On-Machine-Learning-with-R/images/HOMLR.jpg" class="img-fluid"></p>
<p>I am super excited to finally dig into Hands-On Machine Learning with R by <a href="https://www.linkedin.com/in/brad-boehmke-ph-d-9b0a257/">Brad Boehmke, Ph.D.</a> and <a href="https://www.linkedin.com/in/brandon-greenwell-90310b94/">Brandon Greenwell</a>.</p>
<p>There are a ton of solid ML books on the market for Python and R users but I’ve struggled with developing a best practice ML workflow to make maintainable code and to enhance my sampling, evaluation, and iteration process. As an R user, I’m glad to have this hands-on approach resource to improve my use of the ML stack within R.</p>
<p>The full text and code samples are available online, for free: https://lnkd.in/gvmXY3W</p>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>machine learning</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/2019-12-17-Hands-On-Machine-Learning-with-R/2019-12-17-Hands-On-Machine-Learning-with-R.html</guid>
  <pubDate>Tue, 17 Dec 2019 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/2019-12-17-Hands-On-Machine-Learning-with-R/images/HOMLR.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Building a Website with Blogdown</title>
  <dc:creator>Nishant Bharali</dc:creator>
  <link>https://nishantbharali.github.io/Official-Blog/posts/2019-11-18-Blogdown/2019-11-18-Blogdown.html</link>
  <description><![CDATA[ 



<p><img src="https://nishantbharali.github.io/Official-Blog/posts/2019-11-18-Blogdown/images/blogdown.jpg" class="img-fluid"></p>
<p><a href="https://www.linkedin.com/in/pabloibarajas/">Pablo Barajas</a>, a recent graduate at UC Irvine and friend of Scatter Podcast, led a presentation on how to build a website using R, RStudio, and Blogdown.</p>
<p>For anyone wanting to <em>fairly easily</em> build an online portfolio or blog that looks professional, I highly recommend Blogdown. I used this process to build this website, as did Pablo for his personal website, and I can help if you have any questions. Here’s the process in short: RStudio site build with Blogdown -&gt; Commit to GitHub -&gt; Apply Hugo theme -&gt; Netlify for CI/CD</p>
<p>This event was hosted by the Orange County R Users Group (“OCRUG”) and UCI’s Merage Analytics Club (“MAC”). If you’re in Orange County and looking to network and learn with local data science practitioners and students, I highly recommend attending OCRUG events, R-Ladies Irvine events, or public MAC events. Great learning opportunities here!</p>
<p>Links:</p>
<ul>
<li>Pablo’s presentation on <a href="https://pbarajas.rbind.io/posts/website-tutorial/">his Blogdown site</a></li>
<li>Blogdown <a href="https://blog.rstudio.com/2017/09/11/announcing-blogdown/">overview from RStudio</a></li>
<li>OCRUG’s <a href="https://ocrug.org">homepage</a></li>
<li>R-Ladies <a href="https://www.rladiesirvine.org">Irvine chapter</a></li>
<li>Merage Analytics Club <a href="https://sites.uci.edu/merageaa/">website</a></li>
</ul>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section></div> ]]></description>
  <category>rmarkdown</category>
  <category>blogdown</category>
  <guid>https://nishantbharali.github.io/Official-Blog/posts/2019-11-18-Blogdown/2019-11-18-Blogdown.html</guid>
  <pubDate>Mon, 18 Nov 2019 05:00:00 GMT</pubDate>
  <media:content url="https://nishantbharali.github.io/Official-Blog/posts/2019-11-18-Blogdown/images/blogdown.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
